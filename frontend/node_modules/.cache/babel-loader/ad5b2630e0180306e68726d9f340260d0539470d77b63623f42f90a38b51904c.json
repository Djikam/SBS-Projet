{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      users: [],\n      searchQuery: \"\",\n      selectedAgency: \"\",\n      agencies: [],\n      // This will hold the agency list\n      showCompetenceModal: false,\n      selectedUser: {}\n    };\n  },\n  computed: {\n    filteredUsers() {\n      return this.users.filter(user => {\n        const matchesQuery = user.name.toLowerCase().includes(this.searchQuery.toLowerCase());\n        const matchesAgency = this.selectedAgency ? user.agence_id === this.selectedAgency : true;\n        return matchesQuery && matchesAgency;\n      });\n    }\n  },\n  mounted() {\n    this.fetchUsers();\n    this.fetchAgencies(); // Fetch agencies when the component is mounted\n  },\n  methods: {\n    async fetchUsers() {\n      try {\n        let url = \"http://127.0.0.1:8000/api/users/type-zero\";\n        if (this.selectedAgency) {\n          url += `?agence_id=${this.selectedAgency}`;\n        }\n        const response = await axios.get(url, {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.users = response.data;\n      } catch (error) {\n        console.error(\"Error fetching users:\", error);\n      }\n    },\n    async fetchAgencies() {\n      try {\n        const response = await axios.get(\"http://127.0.0.1:8000/api/agences\", {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.agencies = response.data.agences;\n      } catch (error) {\n        console.error(\"Error fetching agencies:\", error);\n      }\n    },\n    async toggleUserStatus(user) {\n      try {\n        // Déterminez l'endpoint en fonction de l'état actuel de l'utilisateur\n        const endpoint = user.active ? `http://127.0.0.1:8000/api/users/${user.id}/deactivate` : `http://127.0.0.1:8000/api/users/${user.id}/activate`;\n\n        // Effectuez l'appel API avec axios\n        await axios.post(endpoint, null, {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n\n        // Mettre à jour localement l'état de l'utilisateur\n        user.active = !user.active;\n      } catch (error) {\n        console.error(\"Error toggling user status:\", error);\n      }\n    },\n    // Méthode pour naviguer vers la page du calendrier de l'utilisateur sélectionné\n    goToUserCalendar(userId) {\n      this.$router.push({\n        name: \"userCalendar\",\n        params: {\n          userId\n        }\n      });\n    },\n    filterByAgency() {\n      this.fetchUsers();\n    },\n    openCompetenceModal(user) {\n      this.selectedUser = user;\n      this.showCompetenceModal = true;\n    },\n    closeCompetenceModal() {\n      this.showCompetenceModal = false;\n    }\n  }\n};","map":{"version":3,"names":["axios","data","users","searchQuery","selectedAgency","agencies","showCompetenceModal","selectedUser","computed","filteredUsers","filter","user","matchesQuery","name","toLowerCase","includes","matchesAgency","agence_id","mounted","fetchUsers","fetchAgencies","methods","url","response","get","headers","Authorization","localStorage","getItem","error","console","agences","toggleUserStatus","endpoint","active","id","post","goToUserCalendar","userId","$router","push","params","filterByAgency","openCompetenceModal","closeCompetenceModal"],"sources":["C:\\Users\\gongue\\Desktop\\frontsbs\\src\\components\\intervenants\\ListPS.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-10\">\r\n    <div class=\"max-w-full mx-auto rounded\">\r\n      <div class=\"relative flex flex-col w-full h-full bg-white shadow-md text-slate-700 rounded-xl bg-clip-border\">\r\n        <!-- Search Bar -->\r\n        <div class=\"p-4\">\r\n          <input\r\n            v-model=\"searchQuery\"\r\n            type=\"text\"\r\n            placeholder=\"Search by name...\"\r\n            class=\"w-full p-2 border rounded border-slate-300\"\r\n          />\r\n        </div>\r\n\r\n        <!-- Table Header and Actions -->\r\n        <div class=\"relative mx-4 mt-4 overflow-hidden bg-white rounded-none text-slate-700 bg-clip-border\">\r\n          <div class=\"flex items-center justify-between\">\r\n            <div>\r\n              <h3 class=\"text-lg font-semibold capitalize text-slate-800\">\r\n                Liste des Consultants\r\n              </h3>\r\n            </div>\r\n            <div class=\"flex flex-col gap-2 shrink-0 sm:flex-row\">\r\n              <router-link\r\n                to=\"/addps\"\r\n                class=\"flex select-none items-center gap-2 rounded bg-slate-800 py-2.5 px-4 text-xs font-semibold text-white shadow-md shadow-slate-900/10 transition-all hover:shadow-lg hover:shadow-slate-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none\"\r\n                type=\"button\"\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\" stroke-width=\"2\" class=\"w-4 h-4\">\r\n                  <path d=\"M6.25 6.375a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0zM3.25 19.125a7.125 7.125 0 0114.25 0v.003l-.001.119a.75.75 0 01-.363.63 13.067 13.067 0 01-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 01-.364-.63l-.001-.122zM19.75 7.5a.75.75 0 00-1.5 0v2.25H16a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H22a.75.75 0 000-1.5h-2.25V7.5z\"></path>\r\n                </svg>\r\n                Ajouter Consultant\r\n              </router-link>\r\n\r\n              <!-- Agency Filter -->\r\n              <div class=\"ml-4\">\r\n                <select v-model=\"selectedAgency\" @change=\"filterByAgency\" class=\"p-2 border rounded\">\r\n                  <option value=\"\">Toutes les agences</option>\r\n                  <option v-for=\"agency in agencies\" :key=\"agency.id\" :value=\"agency.id\">{{ agency.name }}</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Users Table -->\r\n        <div class=\"p-0 overflow-y-scroll\">\r\n          <table class=\"w-full mt-4 text-left table-auto min-w-max\">\r\n            <thead>\r\n              <tr>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Consultant</th>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Role</th>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Statut</th>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Staffing</th>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Compétences</th>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Modifier</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"user in filteredUsers\" :key=\"user.id\">\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <div class=\"flex items-center gap-3\">\r\n                    <div class=\"flex flex-col\">\r\n                      <p class=\"text-sm font-semibold text-slate-700\">{{ user.name }}</p>\r\n                      <p class=\"text-sm text-slate-500\">{{ user.email }}</p>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <div v-if=\"user.type == 0\" class=\"text-sm font-semibold text-teal-700\">\r\n                    Consultant Technique\r\n                  </div>\r\n                  <div v-if=\"user.type == 1\" class=\"text-sm font-semibold text-sky-700\">\r\n                    Consultant Fonctionnel\r\n                  </div>\r\n                  <div v-if=\"user.type == 2\" class=\"text-sm font-semibold text-amber-700\">\r\n                    Consultant FullStack\r\n                  </div>\r\n                  <div v-if=\"user.type == 3\" class=\"text-sm font-semibold text-blue-700\">\r\n                    Chef De Projet\r\n                  </div>\r\n                  <div v-if=\"user.type == 4\" class=\"text-sm font-semibold text-cyan-400\">\r\n                    Manager\r\n                  </div>\r\n                  <div v-if=\"user.type == 5\" class=\"text-sm font-semibold text-slate-700\">\r\n                    Administrateur\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <div class=\"w-max\">\r\n                    <button :class=\"{'bg-red-500/20': user.active, 'bg-green-500/20': !user.active}\" @click=\"toggleUserStatus(user)\" class=\"relative grid items-center w-24 px-2 py-1 font-sans text-xs font-bold text-center uppercase rounded-md cursor-pointer select-none whitespace-nowrap\">\r\n                      <p class=\"text-sm font-semibold capitalize text-slate-700\">{{ user.active ? \"Bloquer ?\" : \"Activer ?\" }}</p>\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <div>\r\n                    <button @click=\"goToUserCalendar(user.id)\" class=\"flex select-none items-center gap-2 rounded bg-slate-800 py-2.5 px-4 text-xs font-semibold text-white shadow-md shadow-slate-900/10 transition-all hover:shadow-lg hover:shadow-slate-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none\">\r\n                      Planning\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <button @click=\"openCompetenceModal(user)\" class=\"text-blue-500 hover:underline\">Compétences</button>\r\n                </td>\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <router-link :to=\"`/updateps/${user.id}`\">\r\n                    <button class=\"relative h-10 max-h-[40px] w-10 max-w-[40px] select-none rounded-lg text-center align-middle font-sans text-xs font-medium uppercase text-slate-900 transition-all hover:bg-slate-900/10 active:bg-slate-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none\">\r\n                      <span class=\"absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2\">\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\" class=\"w-4 h-4\">\r\n                          <path d=\"M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z\"></path>\r\n                        </svg>\r\n                      </span>\r\n                    </button>\r\n                  </router-link>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Modal: Competence -->\r\n    <div v-if=\"showCompetenceModal\" class=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n      <div class=\"absolute inset-0 bg-gray-900 opacity-50\"></div>\r\n      <div class=\"z-50 w-full max-w-md p-6 bg-white rounded-lg\">\r\n        <h2 class=\"mb-4 text-xl font-bold\">Compétences de {{ selectedUser.name }}</h2>\r\n        <div class=\"p-0 overflow-y-scroll\">\r\n          <table class=\"w-full mt-4 text-left table-auto min-w-max\">\r\n            <thead>\r\n              <tr>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Domaine</th>\r\n                <th class=\"p-4 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\">Niveau</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"competence in selectedUser.domaine_competence\" :key=\"competence.id\">\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <p class=\"text-sm font-semibold text-slate-700\">{{ competence.nom }}</p>\r\n                </td>\r\n                <td class=\"p-4 border-b border-slate-200\">\r\n                  <p class=\"text-sm font-semibold text-slate-700\">{{ competence.niveau_competence.niveau }}</p>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div class=\"flex justify-end mt-4\">\r\n          <button type=\"button\" @click=\"closeCompetenceModal\" class=\"px-4 py-2 text-gray-700 bg-gray-300 rounded-full shadow-lg\">Fermer</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      users: [],\r\n      searchQuery: \"\",\r\n      selectedAgency: \"\",\r\n      agencies: [], // This will hold the agency list\r\n      showCompetenceModal: false,\r\n      selectedUser: {}\r\n    };\r\n  },\r\n  computed: {\r\n    filteredUsers() {\r\n      return this.users.filter(user => {\r\n        const matchesQuery = user.name.toLowerCase().includes(this.searchQuery.toLowerCase());\r\n        const matchesAgency = this.selectedAgency ? user.agence_id === this.selectedAgency : true;\r\n        return matchesQuery && matchesAgency;\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.fetchUsers();\r\n    this.fetchAgencies();  // Fetch agencies when the component is mounted\r\n  },\r\n  methods: {\r\n    async fetchUsers() {\r\n      try {\r\n        let url = \"http://127.0.0.1:8000/api/users/type-zero\";\r\n        if (this.selectedAgency) {\r\n          url += `?agence_id=${this.selectedAgency}`;\r\n        }\r\n        const response = await axios.get(url, {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n        this.users = response.data;\r\n      } catch (error) {\r\n        console.error(\"Error fetching users:\", error);\r\n      }\r\n    },\r\n\r\n    async fetchAgencies() {\r\n      try {\r\n        const response = await axios.get(\"http://127.0.0.1:8000/api/agences\", {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n        this.agencies = response.data.agences;\r\n      } catch (error) {\r\n        console.error(\"Error fetching agencies:\", error);\r\n      }\r\n    },\r\n\r\n    async toggleUserStatus(user) {\r\n      try {\r\n        // Déterminez l'endpoint en fonction de l'état actuel de l'utilisateur\r\n        const endpoint = user.active\r\n          ? `http://127.0.0.1:8000/api/users/${user.id}/deactivate`\r\n          : `http://127.0.0.1:8000/api/users/${user.id}/activate`;\r\n\r\n        // Effectuez l'appel API avec axios\r\n        await axios.post(endpoint, null, {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n\r\n        // Mettre à jour localement l'état de l'utilisateur\r\n        user.active = !user.active;\r\n      } catch (error) {\r\n        console.error(\"Error toggling user status:\", error);\r\n      }\r\n    },\r\n\r\n    // Méthode pour naviguer vers la page du calendrier de l'utilisateur sélectionné\r\n    goToUserCalendar(userId) {\r\n      this.$router.push({ name: \"userCalendar\", params: { userId } });\r\n    },\r\n\r\n    filterByAgency() {\r\n      this.fetchUsers();\r\n    },\r\n\r\n    openCompetenceModal(user) {\r\n      this.selectedUser = user;\r\n      this.showCompetenceModal = true;\r\n    },\r\n\r\n    closeCompetenceModal() {\r\n      this.showCompetenceModal = false;\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Add any necessary styles here */\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}