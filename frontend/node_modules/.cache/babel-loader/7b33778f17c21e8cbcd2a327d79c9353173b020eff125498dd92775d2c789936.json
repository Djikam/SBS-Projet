{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.find.js\";\nimport \"core-js/modules/esnext.iterator.for-each.js\";\nimport \"core-js/modules/esnext.iterator.some.js\";\nimport { format } from \"date-fns\";\nimport axios from \"axios\";\nimport jsPDF from 'jspdf';\nimport 'jspdf-autotable';\nimport ExcelJS from 'exceljs';\nimport { API_URL } from '@/config'; // Importer API_URL// Assurez-vous que le chemin est correct\n\nexport default {\n  props: ['userId'],\n  data() {\n    return {\n      colorMapping: {\n        1: {\n          name: 'Mission confirmée',\n          class: 'bg-orange-400'\n        },\n        2: {\n          name: 'Prévision de Mission',\n          class: 'bg-yellow-400'\n        },\n        3: {\n          name: 'Voyage',\n          class: 'bg-sky-400'\n        },\n        4: {\n          name: 'Férié/Congé',\n          class: 'bg-blue-300'\n        },\n        5: {\n          name: 'Formation',\n          class: 'bg-blue-500'\n        },\n        6: {\n          name: 'Récupération',\n          class: 'bg-red-200'\n        },\n        7: {\n          name: 'Congé maladie',\n          class: 'bg-purple-600'\n        },\n        8: {\n          name: 'Université',\n          class: 'bg-sky-600'\n        },\n        9: {\n          name: 'Avant Vente',\n          class: 'bg-teal-300'\n        },\n        10: {\n          name: 'Prévision de Congé',\n          class: 'bg-orange-600'\n        },\n        // Nouvelle couleur pour Prévision de Mission\n        11: {\n          name: 'Prévision de Récupération',\n          class: 'bg-indigo-400'\n        },\n        // Nouvelle couleur pour Prévision de Récupération\n        12: {\n          name: 'Prévision de Formation',\n          class: 'bg-pink-400'\n        },\n        // Nouvelle couleur pour Prévision de Formation\n        default: {\n          name: 'Inconnu',\n          class: 'bg-blue-400'\n        }\n      },\n      viewMode: \"month\",\n      clientSearch: '',\n      isEventModalOpen: false,\n      selectedEvent: {},\n      selectedClient: null,\n      selectedClientId: null,\n      comment: '',\n      startDate: '',\n      endDate: '',\n      importance: 1,\n      user_id: null,\n      monthsOfYear: ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'],\n      hoveredEvent: null,\n      hoveredDay: null,\n      selectedClientColor: ''\n    };\n  },\n  computed: {\n    ...mapState('myCalendar', ['currentYear', 'currentMonth', 'currentDay', 'viewMode', 'resources', 'events', 'clients', 'joursFeries', 'bangeResults', 'searchStartDate', 'searchEndDate', 'tnfSearchResults']),\n    ...mapGetters('myCalendar', ['filteredClients', 'displayPeriod', 'formattedJoursFeries', 'periodDays', 'filteredResources', 'filteredEventsByDay']),\n    statisticsByColor() {\n      return this.calculateStatisticsByColor();\n    }\n  },\n  watch: {\n    searchStartDate() {\n      this.updateView();\n    },\n    searchEndDate() {\n      this.updateView();\n    }\n  },\n  mounted() {\n    this.fetchUserData().then(user => {\n      if (user && user.id) {\n        this.fetchResourcesAndEvents(user.id);\n      }\n    });\n    this.fetchClients();\n    this.fetchJoursFeries();\n  },\n  methods: {\n    ...mapActions('myCalendar', ['fetchUserData', 'fetchResourcesAndEvents', 'fetchClients', 'fetchJoursFeries']),\n    ...mapMutations('myCalendar', ['SET_SEARCH_START_DATE', 'SET_SEARCH_END_DATE', 'SET_CURRENT_YEAR', 'SET_CURRENT_MONTH', 'SET_CURRENT_DAY']),\n    getDayAbbreviation(date) {\n      const days = ['dim', 'lun', 'mar', 'mer', 'jeu', 'ven', 'sam'];\n      return days[date.getDay()];\n    },\n    isWednesday(day, monthIndex) {\n      const date = new Date(this.currentYear, monthIndex, day);\n      return date.getDay() === 3;\n    },\n    getWeeklyBANGE(day, monthIndex = null) {\n      const weekStart = new Date(this.currentYear, monthIndex !== null ? monthIndex : this.currentMonth, day);\n      const weekEnd = new Date(weekStart);\n      weekEnd.setDate(weekStart.getDate() + 6);\n      let totalTNF = 0;\n      let workingDays = 0;\n      for (let d = new Date(weekStart); d <= weekEnd; d.setDate(d.getDate() + 1)) {\n        const dayOfWeek = d.getDay();\n        if (dayOfWeek !== 0 && dayOfWeek !== 6 && !this.isJourFerie(d.getDate(), d.getMonth())) {\n          workingDays++;\n          this.resources.forEach(resource => {\n            const events = this.getEventsForMonth(resource.name, d.getMonth(), d.getDate());\n            if (!events || events.length === 0) {\n              totalTNF++;\n            }\n          });\n        }\n      }\n      const etp = workingDays > 0 ? Math.min(workingDays, 5) : 0;\n      const bange = etp > 0 ? (totalTNF / etp).toFixed(1) : 0;\n      return {\n        bange\n      };\n    },\n    getJourFerieName(day, monthIndex = null) {\n      const date = new Date(this.currentYear, monthIndex !== null ? monthIndex : this.currentMonth, typeof day === 'number' ? day : new Date(day).getDate());\n      const formattedDate = format(date, 'yyyy-MM-dd');\n      const jourFerie = this.formattedJoursFeries.find(jour => jour.date === formattedDate);\n      return jourFerie ? jourFerie.name : 'Férié';\n    },\n    isJourFerie(day, monthIndex = null) {\n      const date = new Date(this.currentYear, monthIndex !== null ? monthIndex : this.currentMonth, typeof day === 'number' ? day : new Date(day).getDate());\n      const formattedDate = format(date, 'yyyy-MM-dd');\n      return this.formattedJoursFeries.some(jour => jour.date === formattedDate);\n    },\n    calculateBusinessDays(startDate, endDate) {\n      let count = 0;\n      const currentDate = new Date(startDate);\n      while (currentDate <= endDate) {\n        const dayOfWeek = currentDate.getDay();\n        if (dayOfWeek !== 0 && dayOfWeek !== 6) {\n          count++;\n        }\n        currentDate.setDate(currentDate.getDate() + 1);\n      }\n      return count;\n    },\n    showComment(event, day) {\n      this.hoveredEvent = event;\n      this.hoveredDay = day;\n    },\n    hideComment() {\n      this.hoveredEvent = null;\n      this.hoveredDay = null;\n    },\n    updateView() {\n      if (this.searchStartDate && this.searchEndDate) {\n        const startDate = new Date(this.searchStartDate);\n        this.SET_CURRENT_YEAR(startDate.getFullYear());\n        this.SET_CURRENT_MONTH(startDate.getMonth());\n      }\n    },\n    clearDateFilters() {\n      this.SET_SEARCH_START_DATE('');\n      this.SET_SEARCH_END_DATE('');\n      this.updateView();\n    },\n    getTNFDaysInPeriod(resource, startDate, endDate) {\n      const tnfDays = [];\n      const resourceEvents = this.events.filter(event => event.resource === resource.name);\n      for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {\n        if (this.isWeekend(d.getDate(), d.getMonth()).isWeekend || this.isJourFerie(d.getDate())) {\n          continue;\n        }\n        const eventsOnDay = resourceEvents.filter(event => this.isEventOnDay(event, d));\n        if (eventsOnDay.length === 0) {\n          tnfDays.push(new Date(d));\n        }\n      }\n      return tnfDays;\n    },\n    isHighlightedTNF(resourceName, day, monthIndex) {\n      if (!this.searchStartDate || !this.searchEndDate) return false;\n      const resource = this.resources.find(r => r.name === resourceName);\n      if (!resource) return false;\n      const date = new Date(this.currentYear, monthIndex !== undefined ? monthIndex : this.currentMonth, day);\n      const startDate = new Date(this.searchStartDate);\n      const endDate = new Date(this.searchEndDate);\n      if (date < startDate || date > endDate || this.isJourFerie(day)) return false;\n      const tnfDays = this.getTNFDaysInPeriod(resource, startDate, endDate);\n      return tnfDays.some(tnfDay => tnfDay.getDate() === date.getDate() && tnfDay.getMonth() === date.getMonth() && tnfDay.getFullYear() === date.getFullYear());\n    },\n    updateSelectedClient() {\n      const selectedClient = this.clients.find(client => client.id === this.selectedClientId);\n      if (selectedClient) {\n        this.selectedClientColor = selectedClient.color;\n      }\n    },\n    selectClient(clientId) {\n      const client = this.clients.find(c => c.id === clientId);\n      if (client) {\n        this.selectedClient = client.nom;\n        this.selectedClientId = client.id;\n        this.selectedClientColor = client.color;\n      } else {\n        this.selectedClient = null;\n        this.selectedClientId = null;\n        this.selectedClientColor = '';\n      }\n    },\n    openEventModal(day, resourceName, monthIndex = null) {\n      let selectedDate;\n      if (monthIndex !== null) {\n        selectedDate = new Date(this.currentYear, monthIndex, day);\n      } else {\n        selectedDate = new Date(this.currentYear, this.currentMonth, day);\n      }\n      if (!isNaN(selectedDate.getTime())) {\n        const headerDate = format(selectedDate, 'yyyy-MM-dd');\n        this.startDate = headerDate;\n        const resource = this.resources.find(r => r.name === resourceName);\n        if (resource) {\n          this.selectedEvent = {\n            resourceName,\n            resourceId: resource.id,\n            day: this.startDate\n          };\n          this.user_id = resource.id;\n          const events = monthIndex !== null ? this.getEventsForMonth(resourceName, monthIndex, day) : this.filteredEventsByDay[resourceName] && this.filteredEventsByDay[resourceName][day] ? this.filteredEventsByDay[resourceName][day] : [];\n          const event = events && events[0];\n          if (event) {\n            const intervention = resource.interventions.find(i => i.id === event.id);\n            console.log(intervention);\n            if (intervention) {\n              this.selectedClientId = intervention.client_id;\n              this.selectedClient = intervention.client_name;\n              this.comment = intervention.commentaire;\n              this.startDate = format(new Date(intervention.date_debut), 'yyyy-MM-dd');\n              this.endDate = format(new Date(intervention.date_fin), 'yyyy-MM-dd');\n              this.selectedClientColor = intervention.client_color;\n              this.selectedEvent.id = intervention.id;\n            }\n          } else {\n            this.selectedClient = null;\n            this.selectedClientId = null;\n            this.comment = '';\n            this.startDate = headerDate;\n            this.endDate = '';\n            this.selectedClientColor = '';\n            this.selectedEvent.id = null;\n          }\n          this.isEventModalOpen = true;\n        }\n      }\n    },\n    async deleteEvent() {\n      const API_URL = 'http://127.0.0.1:8000/api';\n      try {\n        await axios.delete(`${API_URL}/interventions/${this.selectedEvent.id}`, {\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        await this.fetchResourcesAndEvents();\n        this.closeEventModal();\n      } catch (error) {\n        console.error('Erreur lors de la suppression de l\\'événement:', error);\n        if (error.response) {\n          console.error('Détails de l\\'erreur:', error.response.data);\n        }\n      }\n    },\n    closeEventModal() {\n      this.isEventModalOpen = false;\n      this.selectedEvent = {};\n      this.selectedClient = null;\n      this.comment = '';\n      this.startDate = '';\n      this.endDate = '';\n      this.selectedClientColor = '';\n    },\n    resetToToday() {\n      const today = new Date();\n      this.SET_CURRENT_YEAR(today.getFullYear());\n      this.SET_CURRENT_MONTH(today.getMonth());\n      this.SET_CURRENT_DAY(today.getDate());\n    },\n    prevPeriod() {\n      if (this.viewMode === 'month') {\n        this.SET_CURRENT_MONTH(this.currentMonth - 1);\n        if (this.currentMonth < 0) {\n          this.SET_CURRENT_MONTH(11);\n          this.SET_CURRENT_YEAR(this.currentYear - 1);\n        }\n      } else {\n        this.SET_CURRENT_YEAR(this.currentYear - 1);\n      }\n      this.fetchJoursFeries();\n    },\n    nextPeriod() {\n      if (this.viewMode === 'month') {\n        this.SET_CURRENT_MONTH(this.currentMonth + 1);\n        if (this.currentMonth > 11) {\n          this.SET_CURRENT_MONTH(0);\n          this.SET_CURRENT_YEAR(this.currentYear + 1);\n        }\n      } else {\n        this.SET_CURRENT_YEAR(this.currentYear + 1);\n      }\n      this.fetchJoursFeries();\n    },\n    getDayLabel(index, day) {\n      const dayDate = new Date(this.currentYear, this.currentMonth, day);\n      return format(dayDate, 'EEE dd');\n    },\n    getDaysInMonth(monthIndex = null) {\n      const month = monthIndex !== null ? monthIndex : this.currentMonth;\n      const daysInMonth = new Date(this.currentYear, month + 1, 0).getDate();\n      return Array.from({\n        length: daysInMonth\n      }, (_, i) => i + 1);\n    },\n    getDaysInYear() {\n      const months = [];\n      for (let month = 0; month < 12; month++) {\n        const daysInMonth = new Date(this.currentYear, month + 1, 0).getDate();\n        const days = Array.from({\n          length: daysInMonth\n        }, (_, i) => i + 1);\n        months.push({\n          month: format(new Date(this.currentYear, month), 'MMMM'),\n          days\n        });\n      }\n      return months;\n    },\n    isWeekend(day, month = this.currentMonth) {\n      const date = new Date(this.currentYear, month, day);\n      const dayOfWeek = date.getDay();\n      return {\n        isWeekend: dayOfWeek === 0 || dayOfWeek === 6,\n        dayOfWeek\n      };\n    },\n    isEventOnDay(event, day) {\n      const eventStart = new Date(event.startDate);\n      const eventEnd = new Date(event.endDate);\n      const dayOfWeek = day.getDay();\n      const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\n      const dayDate = new Date(day.getFullYear(), day.getMonth(), day.getDate());\n      const eventStartDate = new Date(eventStart.getFullYear(), eventStart.getMonth(), eventStart.getDate());\n      const eventEndDate = new Date(eventEnd.getFullYear(), eventEnd.getMonth(), eventEnd.getDate());\n      if (isWeekend) {\n        return (eventStart.getDay() === 0 || eventStart.getDay() === 6) && dayDate >= eventStartDate && dayDate <= eventEndDate;\n      } else {\n        return eventStart.getDay() !== 0 && eventStart.getDay() !== 6 && dayDate >= eventStartDate && dayDate <= eventEndDate;\n      }\n    },\n    getEventsForMonth(resourceName, monthIndex, day) {\n      const date = new Date(this.currentYear, monthIndex, day);\n      return this.events.filter(event => event.resource === resourceName && this.isEventOnDay(event, date));\n    },\n    getClientColor(color) {\n      if (!color || typeof color !== \"number\") {\n        return this.colorMapping.default.class; // Couleur par défaut si la couleur n'est pas définie ou invalide\n      }\n      return this.colorMapping[color] ? this.colorMapping[color].class : this.colorMapping.default.class;\n    },\n    getColorName(color) {\n      if (!color || typeof color !== \"number\") {\n        return this.colorMapping.default.name; // Nom par défaut si la couleur n'est pas définie ou invalide\n      }\n      return this.colorMapping[color] ? this.colorMapping[color].name : this.colorMapping.default.name;\n    },\n    calculateStatisticsByColor() {\n      const statistics = {};\n      let startDate, endDate;\n      if (this.viewMode === 'month') {\n        startDate = new Date(this.currentYear, this.currentMonth, 1);\n        endDate = new Date(this.currentYear, this.currentMonth + 1, 0);\n      } else if (this.viewMode === 'year') {\n        startDate = new Date(this.currentYear, 0, 1);\n        endDate = new Date(this.currentYear, 11, 31);\n      }\n\n      // Parcourez chaque jour de la période sélectionnée\n      for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {\n        const dayOfWeek = d.getDay();\n        if (dayOfWeek !== 0 && dayOfWeek !== 6 && !this.isJourFerie(d.getDate(), d.getMonth())) {\n          this.events.forEach(event => {\n            const eventStartDate = new Date(event.startDate);\n            const eventEndDate = new Date(event.endDate);\n\n            // Vérifiez si l'événement est actif ce jour-là\n            if (d >= eventStartDate && d <= eventEndDate || d.getDate() === eventStartDate.getDate() && d.getMonth() === eventStartDate.getMonth() && d.getFullYear() === eventStartDate.getFullYear()) {\n              const clientColor = event.color;\n              const clientName = this.getColorName(clientColor);\n              const clientClass = this.getClientColor(clientColor); // Obtenez la classe CSS de la couleur\n\n              if (!statistics[clientColor]) {\n                statistics[clientColor] = {\n                  name: clientName,\n                  count: 0,\n                  color: clientColor,\n                  class: clientClass\n                };\n              }\n              statistics[clientColor].count++;\n            }\n          });\n        }\n      }\n      return statistics;\n    }\n  }\n};","map":{"version":3,"names":["format","axios","jsPDF","ExcelJS","API_URL","props","data","colorMapping","name","class","default","viewMode","clientSearch","isEventModalOpen","selectedEvent","selectedClient","selectedClientId","comment","startDate","endDate","importance","user_id","monthsOfYear","hoveredEvent","hoveredDay","selectedClientColor","computed","mapState","mapGetters","statisticsByColor","calculateStatisticsByColor","watch","searchStartDate","updateView","searchEndDate","mounted","fetchUserData","then","user","id","fetchResourcesAndEvents","fetchClients","fetchJoursFeries","methods","mapActions","mapMutations","getDayAbbreviation","date","days","getDay","isWednesday","day","monthIndex","Date","currentYear","getWeeklyBANGE","weekStart","currentMonth","weekEnd","setDate","getDate","totalTNF","workingDays","d","dayOfWeek","isJourFerie","getMonth","resources","forEach","resource","events","getEventsForMonth","length","etp","Math","min","bange","toFixed","getJourFerieName","formattedDate","jourFerie","formattedJoursFeries","find","jour","some","calculateBusinessDays","count","currentDate","showComment","event","hideComment","SET_CURRENT_YEAR","getFullYear","SET_CURRENT_MONTH","clearDateFilters","SET_SEARCH_START_DATE","SET_SEARCH_END_DATE","getTNFDaysInPeriod","tnfDays","resourceEvents","filter","isWeekend","eventsOnDay","isEventOnDay","push","isHighlightedTNF","resourceName","r","undefined","tnfDay","updateSelectedClient","clients","client","color","selectClient","clientId","c","nom","openEventModal","selectedDate","isNaN","getTime","headerDate","resourceId","filteredEventsByDay","intervention","interventions","i","console","log","client_id","client_name","commentaire","date_debut","date_fin","client_color","deleteEvent","delete","headers","Authorization","localStorage","getItem","closeEventModal","error","response","resetToToday","today","SET_CURRENT_DAY","prevPeriod","nextPeriod","getDayLabel","index","dayDate","getDaysInMonth","month","daysInMonth","Array","from","_","getDaysInYear","months","eventStart","eventEnd","eventStartDate","eventEndDate","getClientColor","getColorName","statistics","clientColor","clientName","clientClass"],"sources":["C:\\Users\\gongue\\Desktop\\frontsbs\\src\\components\\intervenants\\MyCalendar.vue"],"sourcesContent":["<template>\r\n  <div class=\"container p-4 mx-auto\">\r\n  \r\n    <!-- Conteneur principal pour le calcul du bench et la recherche -->\r\n    <div class=\"flex items-center justify-between mb-2\">\r\n      <!-- Formulaire pour le calcul du BANGE -->\r\n      <div class=\"mb-1\">\r\n        <h3 class=\"mb-0   font-medium text-gray-800 text-[9px] uppercase\">\r\n          Calcul du Bench par période\r\n        </h3>\r\n        <div class=\"flex items-center p-2 space-x-6 rounded-lg shadow-md bg-gray-50\">\r\n          <div class=\"flex items-center space-x-2\">\r\n            <label for=\"bange-start-date\" class=\"text-sm font-medium text-gray-700 text-[9px]\">Date de début:</label>\r\n            <input id=\"bange-start-date\" v-model=\"bangeStartDate\" type=\"date\" class=\"p-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300 text-[10px]\" />\r\n          </div>\r\n          <div class=\"flex items-center space-x-2\">\r\n            <label for=\"bange-end-date\" class=\"text-sm font-medium text-gray-700 text-[9px]\">Date de fin:</label>\r\n            <input id=\"bange-end-date\" v-model=\"bangeEndDate\" type=\"date\" class=\"p-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300 text-[10px]\" />\r\n          </div>\r\n          <button @click=\"calculateAndDisplayBANGE\" class=\"p-2 text-[9px] text-white bg-blue-500 rounded shadow-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50\">\r\n            Calculer le Bench\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Modal pour afficher les résultats du BANGE -->\r\n      <div v-if=\"isBANGEModalOpen\" class=\"fixed inset-0 z-[70] flex items-center justify-center bg-black bg-opacity-50\">\r\n        <div class=\"w-full max-w-md p-6 bg-white rounded-lg\">\r\n          <h2 class=\"mb-4 text-xl font-bold\">Résultats du Bench</h2>\r\n          <div class=\"overflow-y-auto max-h-60\">\r\n            <table class=\"w-full\">\r\n              <thead>\r\n                <tr>\r\n                  <th class=\"px-4 py-2 font-semibold text-left bg-gray-100\">Période</th>\r\n                  <th class=\"px-4 py-2 font-semibold text-right bg-gray-100\">Etp</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr v-for=\"result in bangeResults\" :key=\"result.date\" class=\"border-b\">\r\n                  <td class=\"px-4 py-2\">{{ result.date }}</td>\r\n                  <td class=\"px-4 py-2 text-right\">{{ result.bange }}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <button @click=\"closeBANGEModal\" class=\"px-4 py-2 mt-4 text-white bg-blue-500 rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50\">\r\n            Fermer\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Formulaire de recherche -->\r\n      <div class=\"mb-1\">\r\n        <h3 class=\"mb-0  font-medium text-gray-800 text-[9px] uppercase\">Recherche des Consultants en TNF </h3>\r\n        <div class=\"flex items-center p-1 space-x-6 rounded-lg shadow-md bg-gray-50\">\r\n          <div class=\"flex items-center space-x-2\">\r\n            <label for=\"start-search\" class=\"text-sm font-medium text-gray-700 text-[9px]\">Date de début:</label>\r\n            <input id=\"start-search\" v-model=\"searchStartDate\" type=\"date\" class=\"p-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300 text-[9px]\" />\r\n          </div>\r\n          <div class=\"flex items-center space-x-2\">\r\n            <label for=\"end-search\" class=\"text-sm font-medium text-gray-700 text-[9px]\">Date de fin:</label>\r\n            <input id=\"end-search\" v-model=\"searchEndDate\" type=\"date\" class=\"p-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300 text-[9px]\" />\r\n          </div>\r\n          <button @click=\"clearDateFilters\" class=\"p-2 text-[9px] text-white bg-red-500 rounded shadow-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50\">\r\n            Effacer les filtres\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"flex justify-center p-2 space-x-4\">\r\n      <!-- Modal pour sélectionner la période et le format d'exportation -->\r\n      <div v-if=\"isExportModalOpen\" class=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-[70]\">\r\n        <div class=\"w-full max-w-md p-6 bg-white rounded-lg shadow-lg\">\r\n          <h2 class=\"mb-4 text-xl font-bold\">Exporter les données</h2>\r\n          <div class=\"mb-4\">\r\n            <label for=\"start-date\" class=\"block text-sm font-medium text-gray-700\">Date de début :</label>\r\n            <input type=\"date\" v-model=\"startDate\" id=\"start-date\" class=\"p-2 mt-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300\" />\r\n          </div>\r\n          <div class=\"mb-4\">\r\n            <label for=\"end-date\" class=\"block text-sm font-medium text-gray-700\">Date de fin :</label>\r\n            <input type=\"date\" v-model=\"endDate\" id=\"end-date\" class=\"p-2 mt-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300\" />\r\n          </div>\r\n          <div class=\"flex justify-between gap-2\">\r\n            <button @click=\"exportToXLSX\" class=\"px-4 py-2 text-xs text-white bg-green-500 rounded\">Exporter en XLSX</button>\r\n            <button @click=\"exportToPDF\" class=\"px-4 py-2 text-xs text-white bg-blue-500 rounded\">Exporter en PDF</button>\r\n            <button @click=\"closeExportModal\" class=\"px-4 py-2 text-xs text-white bg-red-500 rounded\">Fermer</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- Legend Container -->\r\n      <div class=\"pt-2\">\r\n        <h4 class=\"mb-2 font-medium text-[9px] uppercase\">Statistique par Période</h4>\r\n        <div class=\"flex flex-wrap gap-2\">\r\n          <div v-for=\"(stat, color) in statisticsByColor\" :key=\"color\" class=\"flex items-center p-2 space-x-2 bg-white rounded shadow-md\">\r\n            <div class=\"flex items-center justify-center h-4 p-1\" :class=\"stat.class\">\r\n              <small class=\"text-[8px] text-white\">{{ stat.count }} / {{ totalInterventionDays }} j</small>\r\n            </div>\r\n            <span class=\"text-[8px] text-black\">{{ stat.name }}</span>\r\n            \r\n          </div>\r\n          \r\n        <div class=\"flex items-center p-2 space-x-2 bg-red-500 rounded shadow-md\">\r\n          <div class=\"flex items-center justify-center h-4 p-1\">\r\n            <small class=\"text-[8px] text-white\">{{ totalTNF }} j</small>\r\n          </div>\r\n          <span class=\"text-[8px] text-white\">Total TNF</span>\r\n        </div>\r\n        <div v-for=\"(role, index) in consultantsByRole\" :key=\"index\" class=\"flex items-center p-2 space-x-2 bg-blue-500 rounded shadow-md \">\r\n          <div class=\"flex items-center justify-center h-4 p-1\" :class=\"getClientColor(index)\">\r\n            <small class=\"text-[8px] text-white\">{{ role.count }} / {{ totalConsultants }}</small>\r\n          </div>\r\n          <span class=\"text-[8px] text-white\">{{ role.name }}</span>\r\n        </div>\r\n        \r\n          \r\n        </div>\r\n       \r\n      </div>\r\n    </div>\r\n    <div class=\"flex justify-between p-3 mt-1 bg-blue-500 rounded-t-md\">\r\n      <div class=\"flex items-center justify-\">\r\n        <div>\r\n          <button @click=\"prevPeriod\" class=\"px-4 py-2 text-white bg-blue-500 rounded shadow-lg text-[10px]\">\r\n            Précédent\r\n          </button>\r\n          <button @click=\"resetToToday\" class=\"px-4 py-2 ml-4 text-white bg-green-500 rounded shadow-lg text-[10px]\">\r\n            Mois en cours\r\n          </button>\r\n          <button @click=\"nextPeriod\" class=\"px-4 py-2 ml-4 text-white bg-blue-500 rounded shadow-lg text-[10px]\">\r\n            Suivant\r\n          </button>\r\n          <input id=\"client-search\" v-model=\"clientSearch\" type=\"text\" class=\"px-4 py-2 ml-4 border border-gray-300 rounded-md focus:ring focus:ring-blue-300 text-[10px]\" placeholder=\"Search with client name's\" />\r\n        </div>\r\n      </div>\r\n      <div>\r\n        <h2 class=\"text-2xl font-bold text-white\">{{ displayPeriod }}</h2>\r\n      </div>\r\n      <div class=\"flex\">\r\n        <button @click=\"viewMode = 'month'\" :class=\"{ 'bg-white text-black': viewMode === 'month' }\" class=\"px-4 py-2 transition-colors duration-200 rounded shadow-lg text-[10px]\">\r\n          Mois\r\n        </button>\r\n        <button @click=\"viewMode = 'year'\" :class=\"{ 'bg-white text-black': viewMode === 'year' }\" class=\"px-4 py-2 ml-2 transition-colors duration-200 rounded shadow-lg text-[10px]\">\r\n          Année\r\n        </button>\r\n        <select v-model=\"selectedPays\" class=\"px-4 py-2 ml-2 transition-colors duration-200 rounded shadow-lg text-[10px]\">\r\n          <option value=\"\">Tous les pays</option>\r\n          <option v-for=\"agence in agences\" :key=\"agence.id\" :value=\"agence.pays\">\r\n            {{ agence.pays }}\r\n          </option>\r\n        </select>\r\n        <button @click=\"openExportModal\" class=\"px-4 py-2 ml-2 text-xs text-black rounded bg-gray-50\">Exporter</button>\r\n      </div>\r\n    </div>\r\n<!-- Vue Mensuelle -->\r\n<div v-if=\"viewMode === 'month'\" class=\"overflow-x-auto overflow-y-scroll md:h-[400px]\">\r\n  <table class=\"min-w-full border border-gray-300 table-auto\">\r\n    <thead class=\"sticky z-50 text-white bg-blue-500\">\r\n      <tr class=\"sticky z-50 bg-blue-500\">\r\n        <th class=\"sticky left-0 w-1/4 p-2 text-[9px] z-[70] bg-blue-500 rounded-l-lg\">\r\n          Ressources\r\n        </th>\r\n        <th v-for=\"(day, index) in periodDays\" :key=\"index\" class=\"sticky top-0 p-2 border-b bg-blue-500 z-50 border-gray-300 w-[50px] text-[9px]\">\r\n          {{ getDayLabel(index, day) }}\r\n        </th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <!-- Bench Row -->\r\n      <tr class=\"bench-row\">\r\n        <td class=\"sticky left-0 p-2 bg-white text-[9px] font-bold z-50\">\r\n          Bench\r\n        </td>\r\n        <td v-for=\"(day, index) in periodDays\" :key=\"index\" class=\"p-2 border-b border-gray-300 w-[50px] text-[9px]\">\r\n          {{ getWeeklyBenchForDay(day) }}\r\n        </td>\r\n      </tr>\r\n      <!-- Resource rows -->\r\n      <tr v-for=\"resource in filteredResources\" :key=\"resource.name\">\r\n        <td class=\"sticky left-0 p-1 bg-white text-[10px] z-50\">\r\n          {{ resource.name }}\r\n        </td>\r\n        <td v-for=\"(day, index) in periodDays\" :key=\"index\" class=\"p-1 border-b border-gray-300 w-[50px] text-[9px]\" :class=\"{\r\n            'bg-red-400': isJourFerie(day),\r\n            'bg-gray-300': isWeekend(day).isWeekend,\r\n          }\" @click=\"openEventModal(day, resource.name)\">\r\n          <!-- Holiday Display -->\r\n          <div v-if=\"isJourFerie(day)\" class=\"text-xs font-bold text-white\">\r\n            <div class=\"w-[50px] h-6 p-1 text-[6px] text-white bg-red-400 rounded\">\r\n              {{ getJourFerieName(day, monthIndex) }}\r\n            </div>\r\n          </div>\r\n          <!-- Weekend Display -->\r\n          <div v-else-if=\"isWeekend(day).isWeekend\" class=\"w-full h-full p-1 text-[9px] text-black bg-gray-300 rounded\">\r\n            <template v-if=\"filteredEventsByDay[resource.name][day].length\">\r\n              <div v-for=\"event in filteredEventsByDay[resource.name][day]\" :key=\"event.id\" class=\"relative w-[50px] h-6 p-1 text-[9px] text-center rounded cursor-pointer\" :class=\"getClientColor(event.color)\" @mouseover=\"showComment(event, day)\" @mouseleave=\"hideComment\">\r\n                {{ event.clientAbbreviation }}\r\n              </div>\r\n            </template>\r\n            <template v-else><p class=\"text-[9px]\">weekend</p></template>\r\n          </div>\r\n          <!-- Normal Day Display (not holiday, not weekend) -->\r\n          <div v-else>\r\n            <template v-if=\"filteredEventsByDay[resource.name][day].length\">\r\n              <div v-for=\"event in filteredEventsByDay[resource.name][day]\" :key=\"event.id\" class=\"relative w-[50px] h-6 p-1 text-[9px] text-center rounded cursor-pointer\" :class=\"getClientColor(event.color)\" @mouseover=\"showComment(event, day)\" @mouseleave=\"hideComment\">\r\n                {{ event.clientAbbreviation }}\r\n                <div v-if=\"hoveredEvent === event && hoveredDay === day\" class=\"absolute z-10 p-2 text-sm text-white whitespace-normal bg-gray-800 rounded shadow-lg\" style=\"\r\n                    width: 200px;\r\n                    bottom: 100%;\r\n                    left: 50%;\r\n                    transform: translateX(-50%);\r\n                  \">\r\n                  {{ event.name }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n            <!-- TNF for normal days without events -->\r\n            <template v-else>\r\n              <div v-if=\"!isJourFerie(day)\" class=\"h-6 p-1 text-[9px] text-white bg-green-400 rounded cursor-pointer hover:bg-green-600\" :class=\"{\r\n                  'border-2 border-blue-600': isHighlightedTNF(resource.name, day),\r\n                }\">\r\n                TNF\r\n              </div>\r\n            </template>\r\n          </div>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n    <!-- Vue Annuelle -->\r\n    <div v-else-if=\"viewMode === 'year'\" class=\"overflow-x-auto overflow-y-scroll md:h-[400px]\">\r\n      <div class=\"relative overflow-x-auto\">\r\n        <table class=\"min-w-full border border-gray-900 table-auto\">\r\n          <thead class=\"sticky top-0 z-10 text-white bg-blue-500\">\r\n            <tr>\r\n              <th class=\"sticky left-0 z-50 w-1/4 p-1 bg-blue-500 rounded-l-lg\">Ressources</th>\r\n              <th v-for=\"month in monthsOfYear\" :key=\"month\" class=\"p-1 border border-gray-300\">\r\n                <div>{{ month }}</div>\r\n                <div class=\"flex row-auto gap-1\">\r\n                  <div v-for=\"day in getDaysInMonth(monthsOfYear.indexOf(month))\" :key=\"`${month}-${day}`\" class=\"text-[9px] p-1 w-[50px] mr-[8px]\">\r\n                    {{ getDayAbbreviation(new Date(currentYear, monthsOfYear.indexOf(month), day)) }}\r\n                    {{ String(day).padStart(2, \"0\") }}\r\n                  </div>\r\n                </div>\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody class=\"overflow-x-auto\">\r\n            <!-- Bench Row pour la vue annuelle -->\r\n            <tr class=\"\">\r\n              <td class=\"sticky left-0 p-2 bg-white text-[9px] font-bold gap-2 \">Bench</td>\r\n              <td v-for=\"(month, monthIndex) in getDaysInYear()\" :key=\"monthIndex\" class=\"p-1 border border-gray-300 text-[9px]\">\r\n                <div class=\"flex gap-[2px]\">\r\n                  <div v-for=\"day in month.days\" :key=\"day\" class=\"mx-[5px] text-[9px] text-center bg-transparent w-[50px] h-6 gap-3 rounded-sm\">\r\n                    <!-- Ajout de la condition pour les jours fériés -->\r\n                    <div v-if=\"isJourFerie(day, monthIndex)\">\r\n                      <div class=\"w-[50px] h-6 p-1 text-[1px] text-white bg-transparent rounded\">\r\n                        {{ getJourFerieName(day, monthIndex) }}\r\n                      </div>\r\n                    </div>\r\n                    <div v-else-if=\"isWeekend(day, monthIndex).isWeekend\">\r\n                      <div class=\"w-[50px] h-6 p-1 text-[1px] text-center text-white bg-transparent rounded\">\r\n                        weekend\r\n                      </div>\r\n                    </div>\r\n                    <div v-else>\r\n                      <!-- Afficher le BANGE pour chaque mercredi en vérifiant directement le jour -->\r\n                      <div v-if=\"new Date(currentYear, monthIndex, day).getDay() === 3\" class=\"w-[50px] h-6 p-1 text-[9px] text-white bg-cyan-400 rounded cursor-pointer hover:bg-green-600\">\r\n                        {{ getWeeklyBANGE(day, monthIndex).bange }}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n            <tr v-for=\"resource in filteredResources\" :key=\"resource.name\">\r\n              <td class=\"sticky left-0  p-1 bg-white border text-[9px]\">\r\n                {{ resource.name }}\r\n              </td>\r\n              <td v-for=\"(month, monthIndex) in getDaysInYear()\" :key=\"monthIndex\" class=\"p-1 border border-gray-300 text-[9px]\">\r\n                <div class=\"flex gap-1\">\r\n                  <div v-for=\"day in month.days\" :key=\"day\" class=\"p-1 text-[9px] text-center rounded-lg\" @click=\"openEventModal(day, resource.name, monthIndex)\">\r\n                    <!-- Ajout de la condition pour les jours fériés -->\r\n                    <div v-if=\"isJourFerie(day, monthIndex)\">\r\n                      <div class=\"w-[50px] h-6 p-1 text-[6px] text-white bg-red-400 rounded\">\r\n                        {{ getJourFerieName(day, monthIndex) }}\r\n                      </div>\r\n                    </div>\r\n                    <div v-else-if=\"isWeekend(day, monthIndex).isWeekend\">\r\n                      <div class=\"w-[50px] h-6 p-1 text-[9px] text-center bg-gray-300 rounded\">\r\n                        <template v-if=\"getEventsForMonth(resource.name, monthIndex, day).length\">\r\n                          <div v-for=\"event in getEventsForMonth(resource.name, monthIndex, day)\" :key=\"event.id\" class=\"relative text-center rounded cursor-pointer w-[50px] h-6 p-1 text-[9px]\" :class=\"getClientColor(event.color)\" @mouseover=\"showComment(event, day)\" @mouseleave=\"hideComment\">\r\n                            {{ event.clientAbbreviation }}\r\n                            <div v-if=\"hoveredEvent === event && hoveredDay === day\" class=\"absolute z-10 p-1 text-[9px] text-white whitespace-normal bg-gray-800 rounded shadow-lg\" style=\"\r\n                              width: 200px;\r\n                              bottom: 100%;\r\n                              left: 50%;\r\n                              transform: translateX(-50%);\r\n                            \">\r\n                              {{ event.name }}\r\n                            </div>\r\n                          </div>\r\n                        </template>\r\n                        <template v-else>weekend</template>\r\n                      </div>\r\n                    </div>\r\n                    <div v-else>\r\n                      <template v-if=\"getEventsForMonth(resource.name, monthIndex, day).length\">\r\n                        <div v-for=\"event in getEventsForMonth(resource.name, monthIndex, day)\" :key=\"event.id\" class=\"relative w-[50px] h-6 p-1 text-[9px] text-center rounded cursor-pointer\" :class=\"getClientColor(event.color)\" @mouseover=\"showComment(event, day)\" @mouseleave=\"hideComment\">\r\n                          {{ event.clientAbbreviation }}\r\n                          <div v-if=\"hoveredEvent === event && hoveredDay === day\" class=\"absolute z-10 w-[50px] h-6 p-1 text-[9px] text-white whitespace-normal bg-gray-800 rounded shadow-lg\" style=\"\r\n                            width: 200px;\r\n                            bottom: 100%;\r\n                            left: 50%;\r\n                            transform: translateX(-50%);\r\n                          \">\r\n                            {{ event.name }}\r\n                          </div>\r\n                        </div>\r\n                      </template>\r\n                      <template v-else>\r\n                        <div v-if=\"!isJourFerie(day, monthIndex)\" class=\"w-[50px] h-6 p-1 text-[9px] text-white bg-green-400 rounded cursor-pointer hover:bg-green-600\" :class=\"{\r\n                          'border-2 border-blue-600': isHighlightedTNF(resource.name, day, monthIndex),\r\n                        }\">\r\n                          TNF\r\n                        </div>\r\n                      </template>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n    <!-- Modal pour ajouter/modifier un événement -->\r\n    <div v-if=\"isEventModalOpen\" class=\"fixed inset-0 z-50 flex items-center justify-center p-6 bg-black bg-opacity-50 backdrop-blur-sm\" @click.self=\"closeEventModal\">\r\n      <div class=\"w-full max-w-2xl p-6 transition-transform duration-300 ease-in-out transform scale-75 bg-white rounded-lg shadow-lg\">\r\n        <h3 class=\"mb-4 text-lg font-semibold text-gray-800\">\r\n          Ressource : {{ selectedEvent.resourceName }}\r\n        </h3>\r\n        <div class=\"mt-4\">\r\n          <label for=\"client\" class=\"block text-sm font-medium text-gray-700\">Mission:</label>\r\n          <div>\r\n            <!-- Barre de recherche pour filtrer les clients -->\r\n            <input type=\"text\" v-model=\"clientSearch\" placeholder=\"Rechercher un client\" class=\"w-full p-2 mb-2 border border-gray-300 rounded-md focus:ring focus:ring-blue-500 focus:border-blue-500\" />\r\n            <!-- Sélecteur de clients -->\r\n            <select id=\"client\" v-model=\"selectedClientId\" @change=\"updateSelectedClient\" class=\"w-full p-3 transition duration-150 ease-in-out border border-gray-300 rounded-md focus:ring focus:ring-blue-500 focus:border-blue-500\">\r\n              <option value=\"\">Sélectionnez un client</option>\r\n              <option v-for=\"client in filteredClients\" :key=\"client.id\" :value=\"client.id\">\r\n                {{ client.nom }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div class=\"mt-4\">\r\n          <label for=\"comment\" class=\"block text-sm font-medium text-gray-700\">Commentaire:</label>\r\n          <textarea id=\"comment\" v-model=\"comment\" class=\"w-full p-3 transition duration-150 ease-in-out border border-gray-300 rounded-md focus:ring focus:ring-blue-500 focus:border-blue-500\" placeholder=\"Entrez un commentaire\"></textarea>\r\n        </div>\r\n        <div class=\"flex justify-between mt-4\">\r\n          <div class=\"w-full pr-2\">\r\n            <label for=\"start-date\" class=\"block text-sm font-medium text-gray-700\">Date de début:</label>\r\n            <input id=\"start-date\" type=\"date\" v-model=\"startDate\" class=\"w-full p-3 transition duration-150 ease-in-out border border-gray-300 rounded-md focus:ring focus:ring-blue-500 focus:border-blue-500\" />\r\n          </div>\r\n          <div class=\"w-full pl-2\">\r\n            <label for=\"end-date\" class=\"block text-sm font-medium text-gray-700\">Date de fin:</label>\r\n            <input id=\"end-date\" type=\"date\" v-model=\"endDate\" class=\"w-full p-3 transition duration-150 ease-in-out border border-gray-300 rounded-md focus:ring focus:ring-blue-500 focus:border-blue-500\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"flex space-x-4\">\r\n          <button v-if=\"selectedEvent.id\" @click=\"updateEvent\" class=\"w-full px-4 py-3 mt-6 text-white transition duration-150 ease-in-out bg-green-500 rounded-md hover:bg-green-600 focus:outline-none focus:ring focus:ring-green-300\">\r\n            Mettre à jour l'intervention\r\n          </button>\r\n          <button v-else @click=\"saveEvent\" class=\"w-full px-4 py-3 mt-6 text-white transition duration-150 ease-in-out bg-blue-500 rounded-md hover:bg-blue-600 focus:outline-none focus:ring focus:ring-blue-300\">\r\n            Enregistrer l'intervention\r\n          </button>\r\n          <!-- Button to delete the event -->\r\n          <button v-if=\"selectedEvent.id\" @click=\"deleteEvent\" class=\"w-full px-4 py-3 mt-6 text-white transition duration-150 ease-in-out bg-red-500 rounded-md hover:bg-red-600 focus:outline-none focus:ring focus:ring-red-300\">\r\n            Supprimer l'intervention\r\n          </button>\r\n          <button @click=\"closeEventModal\" class=\"w-full px-4 py-3 mt-6 text-white transition duration-150 ease-in-out bg-gray-500 rounded-md hover:bg-gray-600 focus:outline-none focus:ring focus:ring-gray-300\">\r\n            Fermer\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport { format } from \"date-fns\";\r\nimport axios from \"axios\";\r\nimport jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\nimport ExcelJS from 'exceljs';\r\nimport { API_URL } from '@/config'; // Importer API_URL// Assurez-vous que le chemin est correct\r\n\r\nexport default {\r\n  props: ['userId'],\r\n  data() {\r\n    return {\r\n       colorMapping: {\r\n      1: { name: 'Mission confirmée', class: 'bg-orange-400' },\r\n      2: { name: 'Prévision de Mission', class: 'bg-yellow-400' },\r\n      3: { name: 'Voyage', class: 'bg-sky-400' },\r\n      4: { name: 'Férié/Congé', class: 'bg-blue-300' },\r\n      5: { name: 'Formation', class: 'bg-blue-500' },\r\n      6: { name: 'Récupération', class: 'bg-red-200' },\r\n      7: { name: 'Congé maladie', class: 'bg-purple-600' },\r\n      8: { name: 'Université', class: 'bg-sky-600' },\r\n      9: { name: 'Avant Vente', class: 'bg-teal-300' },\r\n      10: { name: 'Prévision de Congé', class: 'bg-orange-600' }, // Nouvelle couleur pour Prévision de Mission\r\n      11: { name: 'Prévision de Récupération', class: 'bg-indigo-400' }, // Nouvelle couleur pour Prévision de Récupération\r\n      12: { name: 'Prévision de Formation', class: 'bg-pink-400' }, // Nouvelle couleur pour Prévision de Formation\r\n      default: { name: 'Inconnu', class: 'bg-blue-400' }\r\n    },\r\n      viewMode: \"month\",\r\n      clientSearch: '',\r\n      isEventModalOpen: false,\r\n      selectedEvent: {},\r\n      selectedClient: null,\r\n      selectedClientId: null,\r\n      comment: '',\r\n      startDate: '',\r\n      endDate: '',\r\n      importance: 1,\r\n      user_id: null,\r\n      monthsOfYear: [\r\n        'Janvier',\r\n        'Février',\r\n        'Mars',\r\n        'Avril',\r\n        'Mai',\r\n        'Juin',\r\n        'Juillet',\r\n        'Août',\r\n        'Septembre',\r\n        'Octobre',\r\n        'Novembre',\r\n        'Décembre',\r\n      ],\r\n      hoveredEvent: null,\r\n      hoveredDay: null,\r\n      selectedClientColor: '',\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState('myCalendar', [\r\n      'currentYear',\r\n      'currentMonth',\r\n      'currentDay',\r\n      'viewMode',\r\n      'resources',\r\n      'events',\r\n      'clients',\r\n      'joursFeries',\r\n      'bangeResults',\r\n      'searchStartDate',\r\n      'searchEndDate',\r\n      'tnfSearchResults',\r\n    ]),\r\n    ...mapGetters('myCalendar', [\r\n      'filteredClients',\r\n      'displayPeriod',\r\n      'formattedJoursFeries',\r\n      'periodDays',\r\n      'filteredResources',\r\n      'filteredEventsByDay',\r\n    ]),\r\n\r\n    statisticsByColor() {\r\n      return this.calculateStatisticsByColor();\r\n    },\r\n  },\r\n  watch: {\r\n    searchStartDate() {\r\n      this.updateView();\r\n    },\r\n    searchEndDate() {\r\n      this.updateView();\r\n    },\r\n  },\r\n  mounted() {\r\n    this.fetchUserData().then((user) => {\r\n      if (user && user.id) {\r\n        this.fetchResourcesAndEvents(user.id);\r\n      }\r\n    });\r\n    this.fetchClients();\r\n    this.fetchJoursFeries();\r\n  },\r\n  methods: {\r\n    ...mapActions('myCalendar', [\r\n      'fetchUserData',\r\n      'fetchResourcesAndEvents',\r\n      'fetchClients',\r\n      'fetchJoursFeries',\r\n    ]),\r\n    ...mapMutations('myCalendar', [\r\n      'SET_SEARCH_START_DATE',\r\n      'SET_SEARCH_END_DATE',\r\n      'SET_CURRENT_YEAR',\r\n      'SET_CURRENT_MONTH',\r\n      'SET_CURRENT_DAY',\r\n    ]),\r\n    getDayAbbreviation(date) {\r\n      const days = ['dim', 'lun', 'mar', 'mer', 'jeu', 'ven', 'sam'];\r\n      return days[date.getDay()];\r\n    },\r\n    isWednesday(day, monthIndex) {\r\n      const date = new Date(this.currentYear, monthIndex, day);\r\n      return date.getDay() === 3;\r\n    },\r\n    getWeeklyBANGE(day, monthIndex = null) {\r\n      const weekStart = new Date(\r\n        this.currentYear,\r\n        monthIndex !== null ? monthIndex : this.currentMonth,\r\n        day\r\n      );\r\n      const weekEnd = new Date(weekStart);\r\n      weekEnd.setDate(weekStart.getDate() + 6);\r\n\r\n      let totalTNF = 0;\r\n      let workingDays = 0;\r\n\r\n      for (let d = new Date(weekStart); d <= weekEnd; d.setDate(d.getDate() + 1)) {\r\n        const dayOfWeek = d.getDay();\r\n        if (\r\n          dayOfWeek !== 0 &&\r\n          dayOfWeek !== 6 &&\r\n          !this.isJourFerie(d.getDate(), d.getMonth())\r\n        ) {\r\n          workingDays++;\r\n          this.resources.forEach((resource) => {\r\n            const events = this.getEventsForMonth(\r\n              resource.name,\r\n              d.getMonth(),\r\n              d.getDate()\r\n            );\r\n            if (!events || events.length === 0) {\r\n              totalTNF++;\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      const etp = workingDays > 0 ? Math.min(workingDays, 5) : 0;\r\n      const bange = etp > 0 ? (totalTNF / etp).toFixed(1) : 0;\r\n      return { bange };\r\n    },\r\n    getJourFerieName(day, monthIndex = null) {\r\n      const date = new Date(\r\n        this.currentYear,\r\n        monthIndex !== null ? monthIndex : this.currentMonth,\r\n        typeof day === 'number' ? day : new Date(day).getDate()\r\n      );\r\n      const formattedDate = format(date, 'yyyy-MM-dd');\r\n      const jourFerie = this.formattedJoursFeries.find(\r\n        (jour) => jour.date === formattedDate\r\n      );\r\n      return jourFerie ? jourFerie.name : 'Férié';\r\n    },\r\n    isJourFerie(day, monthIndex = null) {\r\n      const date = new Date(\r\n        this.currentYear,\r\n        monthIndex !== null ? monthIndex : this.currentMonth,\r\n        typeof day === 'number' ? day : new Date(day).getDate()\r\n      );\r\n      const formattedDate = format(date, 'yyyy-MM-dd');\r\n      return this.formattedJoursFeries.some((jour) => jour.date === formattedDate);\r\n    },\r\n    calculateBusinessDays(startDate, endDate) {\r\n      let count = 0;\r\n      const currentDate = new Date(startDate);\r\n\r\n      while (currentDate <= endDate) {\r\n        const dayOfWeek = currentDate.getDay();\r\n        if (dayOfWeek !== 0 && dayOfWeek !== 6) {\r\n          count++;\r\n        }\r\n        currentDate.setDate(currentDate.getDate() + 1);\r\n      }\r\n\r\n      return count;\r\n    },\r\n    showComment(event, day) {\r\n      this.hoveredEvent = event;\r\n      this.hoveredDay = day;\r\n    },\r\n    hideComment() {\r\n      this.hoveredEvent = null;\r\n      this.hoveredDay = null;\r\n    },\r\n    updateView() {\r\n      if (this.searchStartDate && this.searchEndDate) {\r\n        const startDate = new Date(this.searchStartDate);\r\n        this.SET_CURRENT_YEAR(startDate.getFullYear());\r\n        this.SET_CURRENT_MONTH(startDate.getMonth());\r\n      }\r\n    },\r\n    clearDateFilters() {\r\n      this.SET_SEARCH_START_DATE('');\r\n      this.SET_SEARCH_END_DATE('');\r\n      this.updateView();\r\n    },\r\n    getTNFDaysInPeriod(resource, startDate, endDate) {\r\n      const tnfDays = [];\r\n      const resourceEvents = this.events.filter(\r\n        (event) => event.resource === resource.name\r\n      );\r\n\r\n      for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {\r\n        if (\r\n          this.isWeekend(d.getDate(), d.getMonth()).isWeekend ||\r\n          this.isJourFerie(d.getDate())\r\n        ) {\r\n          continue;\r\n        }\r\n\r\n        const eventsOnDay = resourceEvents.filter((event) => this.isEventOnDay(event, d));\r\n        if (eventsOnDay.length === 0) {\r\n          tnfDays.push(new Date(d));\r\n        }\r\n      }\r\n\r\n      return tnfDays;\r\n    },\r\n    isHighlightedTNF(resourceName, day, monthIndex) {\r\n      if (!this.searchStartDate || !this.searchEndDate) return false;\r\n\r\n      const resource = this.resources.find((r) => r.name === resourceName);\r\n      if (!resource) return false;\r\n\r\n      const date = new Date(\r\n        this.currentYear,\r\n        monthIndex !== undefined ? monthIndex : this.currentMonth,\r\n        day\r\n      );\r\n      const startDate = new Date(this.searchStartDate);\r\n      const endDate = new Date(this.searchEndDate);\r\n\r\n      if (date < startDate || date > endDate || this.isJourFerie(day)) return false;\r\n\r\n      const tnfDays = this.getTNFDaysInPeriod(resource, startDate, endDate);\r\n\r\n      return tnfDays.some(\r\n        (tnfDay) =>\r\n          tnfDay.getDate() === date.getDate() &&\r\n          tnfDay.getMonth() === date.getMonth() &&\r\n          tnfDay.getFullYear() === date.getFullYear()\r\n      );\r\n    },\r\n    updateSelectedClient() {\r\n      const selectedClient = this.clients.find(\r\n        (client) => client.id === this.selectedClientId\r\n      );\r\n      if (selectedClient) {\r\n        this.selectedClientColor = selectedClient.color;\r\n      }\r\n    },\r\n    selectClient(clientId) {\r\n      const client = this.clients.find((c) => c.id === clientId);\r\n      if (client) {\r\n        this.selectedClient = client.nom;\r\n        this.selectedClientId = client.id;\r\n        this.selectedClientColor = client.color;\r\n      } else {\r\n        this.selectedClient = null;\r\n        this.selectedClientId = null;\r\n        this.selectedClientColor = '';\r\n      }\r\n    },\r\n    openEventModal(day, resourceName, monthIndex = null) {\r\n      let selectedDate;\r\n\r\n      if (monthIndex !== null) {\r\n        selectedDate = new Date(this.currentYear, monthIndex, day);\r\n      } else {\r\n        selectedDate = new Date(this.currentYear, this.currentMonth, day);\r\n      }\r\n\r\n      if (!isNaN(selectedDate.getTime())) {\r\n        const headerDate = format(selectedDate, 'yyyy-MM-dd');\r\n        this.startDate = headerDate;\r\n\r\n        const resource = this.resources.find((r) => r.name === resourceName);\r\n\r\n        if (resource) {\r\n          this.selectedEvent = {\r\n            resourceName,\r\n            resourceId: resource.id,\r\n            day: this.startDate,\r\n          };\r\n          this.user_id = resource.id;\r\n\r\n          const events =\r\n            monthIndex !== null\r\n              ? this.getEventsForMonth(resourceName, monthIndex, day)\r\n              : this.filteredEventsByDay[resourceName] && this.filteredEventsByDay[resourceName][day] ? this.filteredEventsByDay[resourceName][day] : [];\r\n\r\n          const event = events && events[0];\r\n\r\n          if (event) {\r\n            const intervention = resource.interventions.find((i) => i.id === event.id);\r\n            console.log(intervention);\r\n            if (intervention) {\r\n              this.selectedClientId = intervention.client_id;\r\n              this.selectedClient = intervention.client_name;\r\n              this.comment = intervention.commentaire;\r\n              this.startDate = format(new Date(intervention.date_debut), 'yyyy-MM-dd');\r\n              this.endDate = format(new Date(intervention.date_fin), 'yyyy-MM-dd');\r\n              this.selectedClientColor = intervention.client_color;\r\n              this.selectedEvent.id = intervention.id;\r\n            }\r\n          } else {\r\n            this.selectedClient = null;\r\n            this.selectedClientId = null;\r\n            this.comment = '';\r\n            this.startDate = headerDate;\r\n            this.endDate = '';\r\n            this.selectedClientColor = '';\r\n            this.selectedEvent.id = null;\r\n          }\r\n\r\n          this.isEventModalOpen = true;\r\n        }\r\n      }\r\n    },\r\n    async deleteEvent() {\r\n      const API_URL = 'http://127.0.0.1:8000/api';\r\n      try {\r\n        await axios.delete(`${API_URL}/interventions/${this.selectedEvent.id}`, {\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          },\r\n        });\r\n\r\n        await this.fetchResourcesAndEvents();\r\n        this.closeEventModal();\r\n      } catch (error) {\r\n        console.error('Erreur lors de la suppression de l\\'événement:', error);\r\n        if (error.response) {\r\n          console.error('Détails de l\\'erreur:', error.response.data);\r\n        }\r\n      }\r\n    },\r\n    closeEventModal() {\r\n      this.isEventModalOpen = false;\r\n      this.selectedEvent = {};\r\n      this.selectedClient = null;\r\n      this.comment = '';\r\n      this.startDate = '';\r\n      this.endDate = '';\r\n      this.selectedClientColor = '';\r\n    },\r\n    resetToToday() {\r\n      const today = new Date();\r\n      this.SET_CURRENT_YEAR(today.getFullYear());\r\n      this.SET_CURRENT_MONTH(today.getMonth());\r\n      this.SET_CURRENT_DAY(today.getDate());\r\n    },\r\n    prevPeriod() {\r\n      if (this.viewMode === 'month') {\r\n        this.SET_CURRENT_MONTH(this.currentMonth - 1);\r\n        if (this.currentMonth < 0) {\r\n          this.SET_CURRENT_MONTH(11);\r\n          this.SET_CURRENT_YEAR(this.currentYear - 1);\r\n        }\r\n      } else {\r\n        this.SET_CURRENT_YEAR(this.currentYear - 1);\r\n      }\r\n      this.fetchJoursFeries();\r\n    },\r\n    nextPeriod() {\r\n      if (this.viewMode === 'month') {\r\n        this.SET_CURRENT_MONTH(this.currentMonth + 1);\r\n        if (this.currentMonth > 11) {\r\n          this.SET_CURRENT_MONTH(0);\r\n          this.SET_CURRENT_YEAR(this.currentYear + 1);\r\n        }\r\n      } else {\r\n        this.SET_CURRENT_YEAR(this.currentYear + 1);\r\n      }\r\n      this.fetchJoursFeries();\r\n    },\r\n    getDayLabel(index, day) {\r\n      const dayDate = new Date(this.currentYear, this.currentMonth, day);\r\n      return format(dayDate, 'EEE dd');\r\n    },\r\n    getDaysInMonth(monthIndex = null) {\r\n      const month = monthIndex !== null ? monthIndex : this.currentMonth;\r\n      const daysInMonth = new Date(this.currentYear, month + 1, 0).getDate();\r\n      return Array.from({ length: daysInMonth }, (_, i) => i + 1);\r\n    },\r\n    getDaysInYear() {\r\n      const months = [];\r\n      for (let month = 0; month < 12; month++) {\r\n        const daysInMonth = new Date(this.currentYear, month + 1, 0).getDate();\r\n        const days = Array.from({ length: daysInMonth }, (_, i) => i + 1);\r\n        months.push({\r\n          month: format(new Date(this.currentYear, month), 'MMMM'),\r\n          days,\r\n        });\r\n      }\r\n      return months;\r\n    },\r\n    isWeekend(day, month = this.currentMonth) {\r\n      const date = new Date(this.currentYear, month, day);\r\n      const dayOfWeek = date.getDay();\r\n      return { isWeekend: dayOfWeek === 0 || dayOfWeek === 6, dayOfWeek };\r\n    },\r\n    isEventOnDay(event, day) {\r\n      const eventStart = new Date(event.startDate);\r\n      const eventEnd = new Date(event.endDate);\r\n      const dayOfWeek = day.getDay();\r\n      const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\r\n\r\n      const dayDate = new Date(day.getFullYear(), day.getMonth(), day.getDate());\r\n      const eventStartDate = new Date(\r\n        eventStart.getFullYear(),\r\n        eventStart.getMonth(),\r\n        eventStart.getDate()\r\n      );\r\n      const eventEndDate = new Date(\r\n        eventEnd.getFullYear(),\r\n        eventEnd.getMonth(),\r\n        eventEnd.getDate()\r\n      );\r\n\r\n      if (isWeekend) {\r\n        return (\r\n          (eventStart.getDay() === 0 || eventStart.getDay() === 6) &&\r\n          dayDate >= eventStartDate &&\r\n          dayDate <= eventEndDate\r\n        );\r\n      } else {\r\n        return (\r\n          eventStart.getDay() !== 0 &&\r\n          eventStart.getDay() !== 6 &&\r\n          dayDate >= eventStartDate &&\r\n          dayDate <= eventEndDate\r\n        );\r\n      }\r\n    },\r\n    getEventsForMonth(resourceName, monthIndex, day) {\r\n      const date = new Date(this.currentYear, monthIndex, day);\r\n      return this.events.filter(\r\n        (event) => event.resource === resourceName && this.isEventOnDay(event, date)\r\n      );\r\n    },\r\n    getClientColor(color) {\r\n      if (!color || typeof color !== \"number\") {\r\n        return this.colorMapping.default.class; // Couleur par défaut si la couleur n'est pas définie ou invalide\r\n      }\r\n      return this.colorMapping[color] ? this.colorMapping[color].class : this.colorMapping.default.class;\r\n    },\r\n    getColorName(color) {\r\n      if (!color || typeof color !== \"number\") {\r\n        return this.colorMapping.default.name; // Nom par défaut si la couleur n'est pas définie ou invalide\r\n      }\r\n      return this.colorMapping[color] ? this.colorMapping[color].name : this.colorMapping.default.name;\r\n    },\r\ncalculateStatisticsByColor() {\r\n  const statistics = {};\r\n  let startDate, endDate;\r\n\r\n  if (this.viewMode === 'month') {\r\n    startDate = new Date(this.currentYear, this.currentMonth, 1);\r\n    endDate = new Date(this.currentYear, this.currentMonth + 1, 0);\r\n  } else if (this.viewMode === 'year') {\r\n    startDate = new Date(this.currentYear, 0, 1);\r\n    endDate = new Date(this.currentYear, 11, 31);\r\n  }\r\n\r\n  // Parcourez chaque jour de la période sélectionnée\r\n  for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {\r\n    const dayOfWeek = d.getDay();\r\n    if (dayOfWeek !== 0 && dayOfWeek !== 6 && !this.isJourFerie(d.getDate(), d.getMonth())) {\r\n      this.events.forEach(event => {\r\n        const eventStartDate = new Date(event.startDate);\r\n        const eventEndDate = new Date(event.endDate);\r\n\r\n        // Vérifiez si l'événement est actif ce jour-là\r\n        if ((d >= eventStartDate && d <= eventEndDate) || (d.getDate() === eventStartDate.getDate() && d.getMonth() === eventStartDate.getMonth() && d.getFullYear() === eventStartDate.getFullYear())) {\r\n          const clientColor = event.color;\r\n          const clientName = this.getColorName(clientColor);\r\n          const clientClass = this.getClientColor(clientColor); // Obtenez la classe CSS de la couleur\r\n\r\n          if (!statistics[clientColor]) {\r\n            statistics[clientColor] = { name: clientName, count: 0, color: clientColor, class: clientClass };\r\n          }\r\n          statistics[clientColor].count++;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  return statistics;\r\n},\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Ajoutez vos styles ici */\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}