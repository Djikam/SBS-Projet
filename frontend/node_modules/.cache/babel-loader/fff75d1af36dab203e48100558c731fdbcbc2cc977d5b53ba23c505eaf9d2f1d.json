{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport { API_URL } from '@/config';\nexport default {\n  props: [\"id\"],\n  data() {\n    return {\n      form: {\n        nom: \"\",\n        description: \"\",\n        abbreviation: \"\",\n        color: \"\"\n      },\n      errors: {},\n      serverError: \"\"\n    };\n  },\n  methods: {\n    async updateClient() {\n      try {\n        await axios.put(`${API_URL}/clients/${this.id}`, this.form, {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.$router.push(\"/clients\");\n      } catch (error) {\n        console.error(\"Error updating client:\", error);\n        this.serverError = \"Une erreur est survenue lors de la mise à jour du client.\";\n      }\n    },\n    validateForm() {\n      this.errors = {}; // Reset errors\n\n      if (!this.form.nom) {\n        this.errors.nom = \"Le champ nom est requis.\";\n      }\n      if (!this.form.abbreviation) {\n        this.errors.abbreviation = \"Le champ abbreviation est requis.\";\n      }\n      if (!this.form.description) {\n        this.errors.description = \"Le champ description est requis.\";\n      }\n      if (!this.form.color) {\n        this.errors.color = \"Le champ couleur est requis.\";\n      }\n\n      // Si pas d'erreurs, on procède à la mise à jour\n      if (!Object.keys(this.errors).length) {\n        this.updateClient();\n      }\n    },\n    async fetchClientData() {\n      try {\n        const response = await axios.get(`${API_URL}/clients/${this.id}`, {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.form = response.data;\n\n        // Vérifier si le nom commence par \"p_\" et ajuster la couleur en conséquence\n        if (this.form.nom.startsWith('p_') && !this.form.color) {\n          this.form.color = '10';\n        }\n      } catch (error) {\n        console.error(\"Error fetching client data:\", error);\n      }\n    }\n  },\n  watch: {\n    'form.nom': function (newVal) {\n      if (newVal.startsWith('c_') && !this.form.color) {\n        this.form.color = '10';\n      }\n    }\n  },\n  created() {\n    this.fetchClientData();\n  }\n};","map":{"version":3,"names":["axios","API_URL","props","data","form","nom","description","abbreviation","color","errors","serverError","methods","updateClient","put","id","headers","Authorization","localStorage","getItem","$router","push","error","console","validateForm","Object","keys","length","fetchClientData","response","get","startsWith","watch","form.nom","newVal","created"],"sources":["C:\\Users\\gongue\\Desktop\\frontsbs\\src\\components\\clients\\UpdateClientComponent.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- component -->\r\n    <div class=\"flex items-center justify-center min-h-screen p-6 bg-gray-100\">\r\n      <div class=\"container max-w-screen-lg mx-auto\">\r\n        <div>\r\n          <div class=\"p-4 px-4 mb-6 bg-white rounded shadow-lg md:p-8\">\r\n            <div class=\"grid items-center justify-center grid-cols-1 gap-4 text-sm gap-y-2 lg:grid-cols-3\">\r\n              <div class=\"text-gray-600\">\r\n                <img src=\"@/assets/sbsN.jpeg\" alt=\"\" />\r\n                <p class=\"text-lg font-medium\">Modifier un Client</p>\r\n                <p class=\"text-xs\">\r\n                  S'il vous plaît, remplissez les champs que vous désirez modifier\r\n                </p>\r\n              </div>\r\n\r\n              <div class=\"lg:col-span-2\">\r\n                <div class=\"grid grid-cols-1 gap-4 text-sm gap-y-2 md:grid-cols-5\">\r\n                  <div class=\"md:col-span-5\">\r\n                    <label for=\"nom\">Nom</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"nom\"\r\n                      id=\"nom\"\r\n                      class=\"w-full h-10 px-4 mt-1 border rounded bg-gray-50\"\r\n                      v-model=\"form.nom\"\r\n                      placeholder=\"Nom\"\r\n                    />\r\n                    <span v-if=\"errors.nom\" class=\"text-red-500\">{{ errors.nom }}</span>\r\n                  </div>\r\n                  <div class=\"md:col-span-5\">\r\n                    <label for=\"abbreviation\">Abbreviation</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"abbreviation\"\r\n                      id=\"abbreviation\"\r\n                      class=\"w-full h-10 px-4 mt-1 border rounded bg-gray-50\"\r\n                      v-model=\"form.abbreviation\"\r\n                      placeholder=\"Abbreviation\"\r\n                    />\r\n                    <span v-if=\"errors.abbreviation\" class=\"text-red-500\">{{ errors.abbreviation }}</span>\r\n                  </div>\r\n                  <div class=\"md:col-span-5\">\r\n                    <label for=\"description\">Description</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"description\"\r\n                      id=\"description\"\r\n                      class=\"w-full h-10 px-4 mt-1 border rounded bg-gray-50\"\r\n                      v-model=\"form.description\"\r\n                      placeholder=\"Description...\"\r\n                    />\r\n                    <span v-if=\"errors.description\" class=\"text-red-500\">{{ errors.description }}</span>\r\n                  </div>\r\n\r\n                  <div class=\"md:col-span-5\">\r\n                    <label for=\"color\">Couleur</label>\r\n                    <select\r\n                      v-model=\"form.color\"\r\n                      id=\"color\"\r\n                      class=\"w-full h-10 px-4 mt-1 border rounded bg-gray-50\"\r\n                    >\r\n                      <option value=\"\">Sélectionnez une couleur</option>\r\n                      <option value=\"1\">Mission confirmé (Orange)</option>\r\n                      <option value=\"2\">Prévision de mission (Jaune)</option>\r\n                      <option value=\"3\">Voyage (Bleu clair)</option>\r\n                      <option value=\"4\">Congé (Bleu ciel)</option>\r\n                      <option value=\"5\">Formation (Bleu)</option>\r\n                      <option value=\"6\">Récupération (Rouge)</option>\r\n                      <option value=\"7\">Congé maladie (Violet)</option>\r\n                      <option value=\"8\">Université (Bleu ciel)</option>\r\n                      <option value=\"9\">Avant Vente (Vert clair)</option>\r\n                      <option value=\"10\">Prévision de Congé (Vert)</option>\r\n                      <option value=\"11\">Prévision de Récupération (Indigo)</option>\r\n                      <option value=\"12\">Prévision de Formation (Rose)</option>\r\n                    </select>\r\n                    <span v-if=\"errors.color\" class=\"text-red-500\">{{ errors.color }}</span>\r\n                  </div>\r\n\r\n                  <div class=\"text-center md:col-span-5\">\r\n                    <div class=\"inline-flex items-center justify-between space-x-6\">\r\n                      <router-link to=\"/clients\">\r\n                        <button\r\n                          class=\"px-4 py-2 font-bold text-white bg-blue-500 rounded hover:bg-blue-700\"\r\n                        >\r\n                          Retour\r\n                        </button>\r\n                      </router-link>\r\n                      <button\r\n                        @click=\"validateForm\"\r\n                        class=\"px-4 py-2 font-bold text-white bg-blue-500 rounded hover:bg-blue-700\"\r\n                      >\r\n                        Enregistrer\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div v-if=\"serverError\" class=\"text-center text-red-500 md:col-span-5\">\r\n                    {{ serverError }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { API_URL } from '@/config';\r\n\r\nexport default {\r\n  props: [\"id\"],\r\n  data() {\r\n    return {\r\n      form: {\r\n        nom: \"\",\r\n        description: \"\",\r\n        abbreviation: \"\",\r\n        color: \"\",\r\n      },\r\n      errors: {},\r\n      serverError: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    async updateClient() {\r\n      try {\r\n        await axios.put(`${API_URL}/clients/${this.id}`, this.form, {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n        this.$router.push(\"/clients\");\r\n      } catch (error) {\r\n        console.error(\"Error updating client:\", error);\r\n        this.serverError = \"Une erreur est survenue lors de la mise à jour du client.\";\r\n      }\r\n    },\r\n    validateForm() {\r\n      this.errors = {}; // Reset errors\r\n\r\n      if (!this.form.nom) {\r\n        this.errors.nom = \"Le champ nom est requis.\";\r\n      }\r\n      if (!this.form.abbreviation) {\r\n        this.errors.abbreviation = \"Le champ abbreviation est requis.\";\r\n      }\r\n      if (!this.form.description) {\r\n        this.errors.description = \"Le champ description est requis.\";\r\n      }\r\n      if (!this.form.color) {\r\n        this.errors.color = \"Le champ couleur est requis.\";\r\n      }\r\n\r\n      // Si pas d'erreurs, on procède à la mise à jour\r\n      if (!Object.keys(this.errors).length) {\r\n        this.updateClient();\r\n      }\r\n    },\r\n    async fetchClientData() {\r\n      try {\r\n        const response = await axios.get(`${API_URL}/clients/${this.id}`, {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n        this.form = response.data;\r\n\r\n        // Vérifier si le nom commence par \"p_\" et ajuster la couleur en conséquence\r\n        if (this.form.nom.startsWith('p_') && !this.form.color) {\r\n          this.form.color = '10';\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching client data:\", error);\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    'form.nom': function(newVal) {\r\n      if (newVal.startsWith('c_') && !this.form.color) {\r\n        this.form.color = '10';\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchClientData();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Add any necessary styles here */\r\n</style>\r\n"],"mappings":";AA+GA,OAAOA,KAAI,MAAO,OAAO;AACzB,SAASC,OAAM,QAAS,UAAU;AAElC,eAAe;EACbC,KAAK,EAAE,CAAC,IAAI,CAAC;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,IAAI,EAAE;QACJC,GAAG,EAAE,EAAE;QACPC,WAAW,EAAE,EAAE;QACfC,YAAY,EAAE,EAAE;QAChBC,KAAK,EAAE;MACT,CAAC;MACDC,MAAM,EAAE,CAAC,CAAC;MACVC,WAAW,EAAE;IACf,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF,MAAMZ,KAAK,CAACa,GAAG,CAAC,GAAGZ,OAAO,YAAY,IAAI,CAACa,EAAE,EAAE,EAAE,IAAI,CAACV,IAAI,EAAE;UAC1DW,OAAO,EAAE;YACP,cAAc,EAAE,kBAAkB;YAClCC,aAAa,EAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;UACxD;QACF,CAAC,CAAC;QACF,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,UAAU,CAAC;MAC/B,EAAE,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;QAC9C,IAAI,CAACX,WAAU,GAAI,2DAA2D;MAChF;IACF,CAAC;IACDa,YAAYA,CAAA,EAAG;MACb,IAAI,CAACd,MAAK,GAAI,CAAC,CAAC,EAAE;;MAElB,IAAI,CAAC,IAAI,CAACL,IAAI,CAACC,GAAG,EAAE;QAClB,IAAI,CAACI,MAAM,CAACJ,GAAE,GAAI,0BAA0B;MAC9C;MACA,IAAI,CAAC,IAAI,CAACD,IAAI,CAACG,YAAY,EAAE;QAC3B,IAAI,CAACE,MAAM,CAACF,YAAW,GAAI,mCAAmC;MAChE;MACA,IAAI,CAAC,IAAI,CAACH,IAAI,CAACE,WAAW,EAAE;QAC1B,IAAI,CAACG,MAAM,CAACH,WAAU,GAAI,kCAAkC;MAC9D;MACA,IAAI,CAAC,IAAI,CAACF,IAAI,CAACI,KAAK,EAAE;QACpB,IAAI,CAACC,MAAM,CAACD,KAAI,GAAI,8BAA8B;MACpD;;MAEA;MACA,IAAI,CAACgB,MAAM,CAACC,IAAI,CAAC,IAAI,CAAChB,MAAM,CAAC,CAACiB,MAAM,EAAE;QACpC,IAAI,CAACd,YAAY,CAAC,CAAC;MACrB;IACF,CAAC;IACD,MAAMe,eAAeA,CAAA,EAAG;MACtB,IAAI;QACF,MAAMC,QAAO,GAAI,MAAM5B,KAAK,CAAC6B,GAAG,CAAC,GAAG5B,OAAO,YAAY,IAAI,CAACa,EAAE,EAAE,EAAE;UAChEC,OAAO,EAAE;YACP,cAAc,EAAE,kBAAkB;YAClCC,aAAa,EAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;UACxD;QACF,CAAC,CAAC;QACF,IAAI,CAACd,IAAG,GAAIwB,QAAQ,CAACzB,IAAI;;QAEzB;QACA,IAAI,IAAI,CAACC,IAAI,CAACC,GAAG,CAACyB,UAAU,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC1B,IAAI,CAACI,KAAK,EAAE;UACtD,IAAI,CAACJ,IAAI,CAACI,KAAI,GAAI,IAAI;QACxB;MACF,EAAE,OAAOa,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MACrD;IACF;EACF,CAAC;EACDU,KAAK,EAAE;IACL,UAAU,EAAE,SAAAC,CAASC,MAAM,EAAE;MAC3B,IAAIA,MAAM,CAACH,UAAU,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC1B,IAAI,CAACI,KAAK,EAAE;QAC/C,IAAI,CAACJ,IAAI,CAACI,KAAI,GAAI,IAAI;MACxB;IACF;EACF,CAAC;EACD0B,OAAOA,CAAA,EAAG;IACR,IAAI,CAACP,eAAe,CAAC,CAAC;EACxB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}