{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport axios from \"axios\";\nimport { API_URL } from '/config'; // Importer API_URL\n\nexport default {\n  data() {\n    return {\n      isModalOpen: false,\n      selectedClient: null,\n      clients: [],\n      searchQuery: \"\",\n      showDetailModal: false,\n      showAddInterventionModal: false,\n      clientDetail: {},\n      newIntervention: {\n        titre: \"\",\n        commentaire: \"\",\n        date_debut: \"\",\n        date_fin: \"\"\n      }\n    };\n  },\n  computed: {\n    filteredClient() {\n      return this.clients.filter(client => client.nom.toLowerCase().includes(this.searchQuery.toLowerCase()));\n    }\n  },\n  mounted() {\n    this.fetchClients();\n  },\n  methods: {\n    async fetchClients() {\n      try {\n        const response = await axios.get(`${API_URL}/clients`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.clients = response.data;\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async fetchClientDetail(clientId) {\n      try {\n        const response = await axios.get(`${API_URL}/clients/${clientId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.clientDetail = response.data;\n        this.showDetailModal = true;\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async deleteClient(clientId) {\n      if (confirm(\"Es-tu sûr de vouloir supprimer ce client ?\")) {\n        try {\n          await axios.delete(`${API_URL}/clients/${clientId}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n            }\n          });\n          this.clients = this.clients.filter(client => client.id !== clientId);\n        } catch (error) {\n          console.error(error);\n        }\n      }\n    },\n    openDetailModal(client) {\n      this.selectedClient = client;\n      this.isModalOpen = true;\n    },\n    closeDetailModal() {\n      this.isModalOpen = false;\n      this.selectedClient = null;\n    },\n    openAddInterventionModal(clientId) {\n      this.currentClientId = clientId; // Assure-toi que clientId passé ici est valide\n      this.showAddInterventionModal = true;\n    },\n    closeAddInterventionModal() {\n      this.showAddInterventionModal = false;\n    },\n    async addIntervention() {\n      try {\n        await axios.post(`${API_URL}/interventions`, {\n          ...this.newIntervention,\n          // Assure-toi que cela inclut bien client_id\n          client_id: this.currentClientId // Vérifie que currentClientId est bien défini\n        }, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        this.fetchClientDetail(this.currentClientId);\n        this.closeAddInterventionModal();\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","API_URL","data","isModalOpen","selectedClient","clients","searchQuery","showDetailModal","showAddInterventionModal","clientDetail","newIntervention","titre","commentaire","date_debut","date_fin","computed","filteredClient","filter","client","nom","toLowerCase","includes","mounted","fetchClients","methods","response","get","headers","Authorization","localStorage","getItem","error","console","fetchClientDetail","clientId","deleteClient","confirm","delete","id","openDetailModal","closeDetailModal","openAddInterventionModal","currentClientId","closeAddInterventionModal","addIntervention","post","client_id"],"sources":["C:\\Users\\gongue\\Desktop\\frontsbs\\src\\components\\clients\\ClientsComponent.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-10\">\r\n    <div class=\"max-w-full mx-auto rounded\">\r\n      <div\r\n        class=\"relative flex flex-col w-full h-full bg-white shadow-md text-slate-700 rounded-xl bg-clip-border\"\r\n      >\r\n        <!-- Search Bar -->\r\n        <div class=\"p-4\">\r\n          <input\r\n            v-model=\"searchQuery\"\r\n            type=\"text\"\r\n            placeholder=\"Search by name...\"\r\n            class=\"w-full p-2 border rounded border-slate-300\"\r\n          />\r\n        </div>\r\n\r\n        <!-- Table Header and Actions -->\r\n        <div\r\n          class=\"relative mx-4 mt-4 overflow-hidden bg-white rounded-none text-slate-700 bg-clip-border\"\r\n        >\r\n          <div class=\"flex items-center justify-between\">\r\n            <div>\r\n              <h3 class=\"text-lg font-semibold capitalize text-slate-800\">\r\n                liste des Clients\r\n              </h3>\r\n            </div>\r\n            <div class=\"flex flex-col gap-2 shrink-0 sm:flex-row\">\r\n              <router-link\r\n                to=\"/addclient\"\r\n                class=\"flex select-none items-center gap-2 rounded bg-slate-800 py-2 px-4 text-xs font-semibold text-white shadow-md shadow-slate-900/10 transition-all hover:shadow-lg hover:shadow-slate-900/20 focus:opacity-[0.85] focus:shadow-none active:opacity-[0.85] active:shadow-none disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none\"\r\n                type=\"button\"\r\n              >\r\n                <svg\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  viewBox=\"0 0 24 24\"\r\n                  fill=\"currentColor\"\r\n                  aria-hidden=\"true\"\r\n                  stroke-width=\"2\"\r\n                  class=\"w-4 h-4\"\r\n                >\r\n                  <path\r\n                    d=\"M6.25 6.375a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0zM3.25 19.125a7.125 7.125 0 0114.25 0v.003l-.001.119a.75.75 0 01-.363.63 13.067 13.067 0 01-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 01-.364-.63l-.001-.122zM19.75 7.5a.75.75 0 00-1.5 0v2.25H16a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H22a.75.75 0 000-1.5h-2.25V7.5z\"\r\n                  ></path>\r\n                </svg>\r\n                Ajouter un Client\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Users Table -->\r\n        <div class=\"p-0 overflow-y-scroll\">\r\n          <table class=\"w-full mt-4 text-sm text-left table-auto min-w-max\">\r\n            <thead>\r\n              <tr>\r\n                <th\r\n                  class=\"p-2 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\"\r\n                >\r\n                  <p\r\n                    class=\"flex items-center justify-between gap-2 font-sans leading-none text-slate-500\"\r\n                  >\r\n                    Noms\r\n                  </p>\r\n                </th>\r\n                <th\r\n                  class=\"p-2 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\"\r\n                >\r\n                  <p\r\n                    class=\"flex items-center justify-between gap-2 font-sans leading-none text-slate-500\"\r\n                  >\r\n                    Abbreviation\r\n                  </p>\r\n                </th>\r\n                <th\r\n                  class=\"p-2 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\"\r\n                >\r\n                  <p\r\n                    class=\"flex items-center justify-between gap-2 font-sans leading-none text-slate-500\"\r\n                  >\r\n                    Description\r\n                  </p>\r\n                </th>\r\n\r\n                <th\r\n                  class=\"p-2 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\"\r\n                >\r\n                  <p\r\n                    class=\"flex items-center justify-between gap-2 font-sans leading-none text-slate-500\"\r\n                  >\r\n                    Modifier\r\n                    <svg\r\n                      xmlns=\"http://www.w3.org/2000/svg\"\r\n                      fill=\"none\"\r\n                      viewBox=\"0 0 24 24\"\r\n                      stroke-width=\"2\"\r\n                      stroke=\"currentColor\"\r\n                      aria-hidden=\"true\"\r\n                      class=\"w-4 h-4\"\r\n                    >\r\n                      <path\r\n                        stroke-linecap=\"round\"\r\n                        stroke-linejoin=\"round\"\r\n                        d=\"M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9\"\r\n                      ></path>\r\n                    </svg>\r\n                  </p>\r\n                </th>\r\n                <th\r\n                  class=\"p-2 transition-colors cursor-pointer border-y border-slate-200 bg-slate-50 hover:bg-slate-100\"\r\n                >\r\n                  <p\r\n                    class=\"flex items-center justify-between gap-2 font-sans leading-none text-slate-500\"\r\n                  >\r\n                    Supprimer\r\n                  </p>\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"client in filteredClient\" :key=\"client.id\">\r\n                <td class=\"p-2 border-b border-slate-200\">\r\n                  <div class=\"flex items-center gap-3\">\r\n                    <div class=\"flex flex-col\">\r\n                      <p class=\"text-sm font-semibold uppercase text-slate-700\">\r\n                        {{ client.nom }}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-2 border-b border-slate-200\">\r\n                  <div class=\"flex flex-col\">\r\n                    <p class=\"text-sm font-semibold text-slate-700\">\r\n                      {{ client.abbreviation }}\r\n                    </p>\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-2 border-b border-slate-200\">\r\n                  <div class=\"flex flex-col\">\r\n                    <p class=\"text-[9px] font-semibold text-slate-700 whitespace-normal\">\r\n                      {{ client.description }}\r\n                    </p>\r\n                  </div>\r\n                </td>\r\n                <td class=\"p-2 border-b border-slate-200\">\r\n                  <router-link :to=\"`/updateclient/${client.id}`\">\r\n                    <button\r\n                      class=\"relative w-8 h-8 font-sans text-xs font-medium text-center uppercase align-middle transition-all rounded-lg select-none text-slate-900 hover:bg-slate-900/10 active:bg-slate-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none\"\r\n                    >\r\n                      <span\r\n                        class=\"absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2\"\r\n                      >\r\n                        <svg\r\n                          xmlns=\"http://www.w3.org/2000/svg\"\r\n                          viewBox=\"0 0 24 24\"\r\n                          fill=\"currentColor\"\r\n                          aria-hidden=\"true\"\r\n                          class=\"w-4 h-4\"\r\n                        >\r\n                          <path\r\n                            d=\"M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z\"\r\n                          ></path>\r\n                        </svg>\r\n                      </span>\r\n                    </button>\r\n                  </router-link>\r\n                </td>\r\n                <td class=\"p-2 border-b border-slate-200\">\r\n                  <button\r\n                    @click=\"deleteClient(client.id)\"\r\n                    class=\"relative w-8 h-8 font-sans text-xs font-medium text-center text-red-600 uppercase align-middle transition-all rounded-lg select-none hover:bg-red-600/10 active:bg-red-600/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none\"\r\n                  >\r\n                    <span\r\n                      class=\"absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2\"\r\n                    >\r\n                      <svg\r\n                        xmlns=\"http://www.w3.org/2000/svg\"\r\n                        viewBox=\"0 0 24 24\"\r\n                        fill=\"currentColor\"\r\n                        aria-hidden=\"true\"\r\n                        class=\"w-4 h-4\"\r\n                      >\r\n                        <path\r\n                          d=\"M3 6h18M9 6V4a1 1 0 011-1h4a1 1 0 011 1v2M10 6h4m-6 1v12a1 1 0 001 1h8a1 1 0 001-1V7H4z\"\r\n                        ></path>\r\n                      </svg>\r\n                    </span>\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { API_URL } from '/config'; // Importer API_URL\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isModalOpen: false,\r\n      selectedClient: null,\r\n      clients: [],\r\n      searchQuery: \"\",\r\n      showDetailModal: false,\r\n      showAddInterventionModal: false,\r\n      clientDetail: {},\r\n      newIntervention: {\r\n        titre: \"\",\r\n        commentaire: \"\",\r\n        date_debut: \"\",\r\n        date_fin: \"\",\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    filteredClient() {\r\n      return this.clients.filter((client) =>\r\n        client.nom.toLowerCase().includes(this.searchQuery.toLowerCase())\r\n      );\r\n    },\r\n  },\r\n  mounted() {\r\n    this.fetchClients();\r\n  },\r\n  methods: {\r\n    async fetchClients() {\r\n      try {\r\n        const response = await axios.get(`${API_URL}/clients`, {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n        this.clients = response.data;\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    },\r\n    async fetchClientDetail(clientId) {\r\n      try {\r\n        const response = await axios.get(\r\n          `${API_URL}/clients/${clientId}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n            },\r\n          }\r\n        );\r\n        this.clientDetail = response.data;\r\n        this.showDetailModal = true;\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    },\r\n    async deleteClient(clientId) {\r\n      if (confirm(\"Es-tu sûr de vouloir supprimer ce client ?\")) {\r\n        try {\r\n          await axios.delete(`${API_URL}/clients/${clientId}`, {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n            },\r\n          });\r\n          this.clients = this.clients.filter((client) => client.id !== clientId);\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n      }\r\n    },\r\n    openDetailModal(client) {\r\n      this.selectedClient = client;\r\n      this.isModalOpen = true;\r\n    },\r\n    closeDetailModal() {\r\n      this.isModalOpen = false;\r\n      this.selectedClient = null;\r\n    },\r\n    openAddInterventionModal(clientId) {\r\n      this.currentClientId = clientId; // Assure-toi que clientId passé ici est valide\r\n      this.showAddInterventionModal = true;\r\n    },\r\n    closeAddInterventionModal() {\r\n      this.showAddInterventionModal = false;\r\n    },\r\n    async addIntervention() {\r\n      try {\r\n        await axios.post(\r\n          `${API_URL}/interventions`,\r\n          {\r\n            ...this.newIntervention, // Assure-toi que cela inclut bien client_id\r\n            client_id: this.currentClientId, // Vérifie que currentClientId est bien défini\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n            },\r\n          }\r\n        );\r\n        this.fetchClientDetail(this.currentClientId);\r\n        this.closeAddInterventionModal();\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n/* Add any necessary styles here */\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}